[program started on Fri Jan 15 16:33:04 2016] 
[command line arguments] 
[----------------------] 
-------------------------------------------------------------------------------- 
LSTM for VQA with text only 
-------------------------------------------------------------------------------- 
loading COCOQA datasets 
Append captions with question done. 
Remove determiner done. 
num train = 78736 
num test  = 38948 
-------------------------------------------------------------------------------- 
model configuration 
-------------------------------------------------------------------------------- 
max epochs                = 100 
num params                = 95230 
num compositional params  = 30300 
word vector dim           = 50 
LSTM memory dim           = 150 
LSTM structure            = rnn 
LSTM layers               = 1 
regularization strength   = 1.00e-04 
minibatch size            = 1 
learning rate             = 5.00e-02 
word vector learning rate = 1.00e-01 
dropout                   = true 
cuda                      = true 
image feature dim         = [text only] 
-------------------------------------------------------------------------------- 
Training model 
-------------------------------------------------------------------------------- 
-- epoch 1 
-- finished epoch in 263.52s 
-- train score: 0.06172525909368, cost 409.47s 
-- test score: 0.056896374653384, cost 199.86s 
-- epoch 2 
-- finished epoch in 253.12s 
-- train score: 0.10796840073156, cost 403.08s 
-- test score: 0.10444695491424, cost 199.29s 
-- epoch 3 
-- finished epoch in 256.58s 
-- train score: 0.20788457630563, cost 398.57s 
-- test score: 0.19736571839376, cost 196.92s 
-- epoch 4 
-- finished epoch in 252.03s 
-- train score: 0.257188579557, cost 398.88s 
-- test score: 0.23972989627195, cost 197.26s 
-- epoch 5 
-- finished epoch in 251.95s 
-- train score: 0.31840581182686, cost 399.10s 
-- test score: 0.29557358529321, cost 197.31s 
-- epoch 6 
-- finished epoch in 251.68s 
-- train score: 0.34829048973786, cost 399.04s 
-- test score: 0.32643524699599, cost 197.32s 
-- epoch 7 
-- finished epoch in 252.00s 
-- train score: 0.37447927250559, cost 399.01s 
-- test score: 0.34610249563521, cost 197.34s 
-- epoch 8 
-- finished epoch in 280.81s 
-- train score: 0.38476681568787, cost 419.01s 
-- test score: 0.35416452706172, cost 207.19s 
-- epoch 9 
-- finished epoch in 266.48s 
-- train score: 0.40786933550091, cost 393.79s 
-- test score: 0.37542364177878, cost 201.21s 
-- epoch 10 
-- finished epoch in 256.03s 
-- train score: 0.41272099166836, cost 400.71s 
-- test score: 0.37716955941255, cost 198.57s 
-- epoch 11 
-- finished epoch in 256.54s 
-- train score: 0.43515037593985, cost 400.61s 
-- test score: 0.40043134435658, cost 198.08s 
-- epoch 12 
-- finished epoch in 257.12s 
-- train score: 0.44533631375737, cost 401.03s 
-- test score: 0.40536099414604, cost 197.62s 
-- epoch 13 
-- finished epoch in 256.39s 
-- train score: 0.46601300548669, cost 402.22s 
-- test score: 0.42792954708843, cost 197.47s 
-- epoch 14 
-- finished epoch in 252.24s 
-- train score: 0.47329048973786, cost 399.03s 
-- test score: 0.43062544931704, cost 197.34s 
-- epoch 15 
-- finished epoch in 253.55s 
-- train score: 0.48520371875635, cost 418.49s 
-- test score: 0.43686453733183, cost 207.01s 
-- epoch 16 
-- finished epoch in 288.29s 
-- train score: 0.49527535053851, cost 418.30s 
-- test score: 0.44626168224299, cost 206.83s 
-- epoch 17 
-- finished epoch in 290.19s 
-- train score: 0.5082935378988, cost 418.75s 
-- test score: 0.45517099722707, cost 207.05s 
-- epoch 18 
-- finished epoch in 288.28s 
-- train score: 0.51331030278399, cost 400.39s 
-- test score: 0.45953579131149, cost 197.24s 
-- epoch 19 
-- finished epoch in 254.50s 
-- train score: 0.51380562893721, cost 398.60s 
-- test score: 0.45822635308617, cost 197.09s 
-- epoch 20 
-- finished epoch in 253.27s 
-- train score: 0.52756045519203, cost 399.11s 
-- test score: 0.46816267844305, cost 197.35s 
-- epoch 21 
-- finished epoch in 253.50s 
-- train score: 0.5138183296078, cost 399.83s 
-- test score: 0.45840607990141, cost 197.54s 
-- epoch 22 
-- finished epoch in 252.09s 
-- train score: 0.39129496037391, cost 399.27s 
-- test score: 0.3490294751977, cost 197.46s 
-- epoch 23 
-- finished epoch in 267.70s 
-- train score: 0.5279287746393, cost 418.81s 
-- test score: 0.47029372496662, cost 207.02s 
-- epoch 24 
-- finished epoch in 272.03s 
-- train score: 0.54040083316399, cost 398.46s 
-- test score: 0.47542877683065, cost 197.04s 
-- epoch 25 
-- finished epoch in 252.23s 
-- train score: 0.54997713879293, cost 399.39s 
-- test score: 0.48413268974017, cost 197.50s 
-- epoch 26 
-- finished epoch in 252.51s 
-- train score: 0.53119284698232, cost 398.36s 
-- test score: 0.4702680497073, cost 199.59s 
-- epoch 27 
-- finished epoch in 255.07s 
-- train score: 0.55792775858565, cost 401.44s 
-- test score: 0.4878812776009, cost 200.01s 
-- epoch 28 
-- finished epoch in 251.69s 
-- train score: 0.47035663483032, cost 400.71s 
-- test score: 0.4170432371367, cost 198.20s 
-- epoch 29 
-- finished epoch in 251.70s 
-- train score: 0.51762853078643, cost 401.63s 
-- test score: 0.45915066242169, cost 198.60s 
-- epoch 30 
-- finished epoch in 253.81s 
-- train score: 0.49571987400935, cost 401.40s 
-- test score: 0.44235904282633, cost 198.47s 
-- epoch 31 
-- finished epoch in 251.54s 
-- train score: 0.52387726071937, cost 401.66s 
-- test score: 0.4621033172435, cost 198.62s 
-- epoch 32 
-- finished epoch in 251.58s 
-- train score: 0.44252946555578, cost 401.76s 
-- test score: 0.39414090582315, cost 198.69s 
-- epoch 33 
-- finished epoch in 251.54s 
-- train score: 0.47896768949401, cost 401.82s 
-- test score: 0.42156208277704, cost 198.69s 
-- epoch 34 
-- finished epoch in 251.55s 
-- train score: 0.51301818736029, cost 401.88s 
-- test score: 0.45067782684605, cost 198.73s 
-- epoch 35 
-- finished epoch in 265.27s 
-- train score: 0.51228154846576, cost 398.48s 
-- test score: 0.45036972373421, cost 197.01s 
-- epoch 36 
-- finished epoch in 257.88s 
-- train score: 0.53029109937005, cost 400.05s 
-- test score: 0.46320735339427, cost 197.77s 
-- epoch 37 
-- finished epoch in 257.18s 
-- train score: 0.54473176183702, cost 412.96s 
-- test score: 0.47627606038821, cost 207.02s 
-- epoch 38 
-- finished epoch in 288.69s 
-- train score: 0.55331741515952, cost 418.77s 
-- test score: 0.48138543699291, cost 207.10s 
-- epoch 39 
-- finished epoch in 287.58s 
-- train score: 0.53632391790287, cost 418.77s 
-- test score: 0.46328437917223, cost 207.05s 
-- epoch 40 
-- finished epoch in 287.56s 
-- train score: 0.55660688884373, cost 418.77s 
-- test score: 0.48331108144192, cost 207.07s 
-- epoch 41 
-- finished epoch in 256.81s 
-- train score: 0.57112375533428, cost 400.53s 
-- test score: 0.49370956146657, cost 197.63s 
-- epoch 42 
-- finished epoch in 252.54s 
-- train score: 0.56505283478968, cost 398.58s 
-- test score: 0.4877529013043, cost 197.09s 
-- epoch 43 
-- finished epoch in 253.51s 
-- train score: 0.57915057915058, cost 399.57s 
-- test score: 0.49804868029167, cost 197.55s 
-- epoch 44 
-- finished epoch in 251.09s 
-- train score: 0.58597083926031, cost 399.55s 
-- test score: 0.50187429393037, cost 197.52s 
-- epoch 45 
-- finished epoch in 251.16s 
-- train score: 0.39730237756554, cost 399.24s 
-- test score: 0.34589709356064, cost 197.43s 
-- epoch 46 
-- finished epoch in 254.36s 
-- train score: 0.57029821174558, cost 419.72s 
-- test score: 0.49283660264969, cost 207.26s 
-- epoch 47 
-- finished epoch in 286.78s 
-- train score: 0.58677098150782, cost 419.35s 
-- test score: 0.50238779911677, cost 207.44s 
-- epoch 48 
-- finished epoch in 287.93s 
-- train score: 0.59450568990043, cost 419.38s 
-- test score: 0.50724042312827, cost 207.41s 
-- epoch 49 
-- finished epoch in 287.78s 
-- train score: 0.59642349116033, cost 419.24s 
-- test score: 0.50600801068091, cost 207.33s 
-- epoch 50 
-- finished epoch in 287.91s 
-- train score: 0.59975106685633, cost 419.22s 
-- test score: 0.50916606757728, cost 207.34s 
-- epoch 51 
-- finished epoch in 287.82s 
-- train score: 0.60419630156472, cost 419.44s 
-- test score: 0.5089349902434, cost 207.41s 
-- epoch 52 
-- finished epoch in 287.76s 
-- train score: 0.59497561471246, cost 419.45s 
-- test score: 0.50862688713156, cost 207.33s 
-- epoch 53 
-- finished epoch in 287.82s 
-- train score: 0.60654592562487, cost 419.28s 
-- test score: 0.51312005751258, cost 207.14s 
-- epoch 54 
-- finished epoch in 269.49s 
-- train score: 0.60522505588295, cost 398.08s 
-- test score: 0.50613638697751, cost 198.03s 
-- epoch 55 
-- finished epoch in 251.66s 
-- train score: 0.6020371875635, cost 401.96s 
-- test score: 0.50539180445722, cost 198.68s 
-- epoch 56 
-- finished epoch in 255.98s 
-- train score: 0.60636811623654, cost 399.24s 
-- test score: 0.51047550580261, cost 197.40s 
-- epoch 57 
-- finished epoch in 252.25s 
-- train score: 0.61673186344239, cost 398.25s 
-- test score: 0.51535380507343, cost 196.91s 
-- epoch 58 
-- finished epoch in 252.00s 
-- train score: 0.61994513310303, cost 399.30s 
-- test score: 0.51553353188867, cost 197.48s 
-- epoch 59 
-- finished epoch in 253.51s 
-- train score: 0.60846372688478, cost 398.08s 
-- test score: 0.509705248023, cost 196.78s 
-- epoch 60 
-- finished epoch in 255.40s 
-- train score: 0.60634271489535, cost 391.36s 
-- test score: 0.5089349902434, cost 193.48s 
-- epoch 61 
-- finished epoch in 255.58s 
-- train score: 0.62049126193863, cost 397.08s 
-- test score: 0.51910239293417, cost 197.68s 
-- epoch 62 
-- finished epoch in 252.33s 
-- train score: 0.62769254216623, cost 400.50s 
-- test score: 0.51846051145117, cost 198.02s 
-- epoch 63 
-- finished epoch in 266.03s 
-- train score: 0.62840377971957, cost 419.06s 
-- test score: 0.51833213515457, cost 207.15s 
-- epoch 64 
-- finished epoch in 285.44s 
-- train score: 0.63350944929892, cost 417.94s 
-- test score: 0.52095101160522, cost 207.06s 
-- epoch 65 
-- finished epoch in 282.54s 
-- train score: 0.62950873806137, cost 395.18s 
-- test score: 0.51871726404437, cost 193.60s 
-- epoch 66 
-- finished epoch in 262.75s 
-- train score: 0.61458545011177, cost 401.36s 
-- test score: 0.50688096949779, cost 194.54s 
-- epoch 67 
-- finished epoch in 255.53s 
-- train score: 0.62558423084739, cost 401.22s 
-- test score: 0.51579028448187, cost 206.90s 
-- epoch 68 
-- finished epoch in 282.71s 
-- train score: 0.63253149766308, cost 418.90s 
-- test score: 0.51987265071377, cost 207.12s 
-- epoch 69 
-- finished epoch in 287.62s 
-- train score: 0.58547551310709, cost 419.00s 
-- test score: 0.48867721063983, cost 207.20s 
-- epoch 70 
-- finished epoch in 287.67s 
-- train score: 0.62754013411908, cost 418.26s 
-- test score: 0.51889699085961, cost 206.80s 
-- epoch 71 
-- finished epoch in 287.41s 
-- train score: 0.62916581995529, cost 418.86s 
-- test score: 0.51522542877683, cost 207.09s 
-- epoch 72 
-- finished epoch in 285.91s 
-- train score: 0.63363645600488, cost 398.48s 
-- test score: 0.51894834137825, cost 197.00s 
-- epoch 73 
-- finished epoch in 251.39s 
-- train score: 0.63719264377159, cost 399.43s 
-- test score: 0.5207969600493, cost 197.45s 
-- epoch 74 
-- finished epoch in 261.88s 
-- train score: 0.64112985165617, cost 391.34s 
-- test score: 0.51866591352573, cost 193.37s 
-- epoch 75 
-- finished epoch in 253.15s 
-- train score: 0.61678266612477, cost 401.48s 
-- test score: 0.50680394371983, cost 198.34s 
-- epoch 76 
-- finished epoch in 252.63s 
-- train score: 0.6352240398293, cost 401.10s 
-- test score: 0.51804970730204, cost 198.28s 
-- epoch 77 
-- finished epoch in 252.52s 
-- train score: 0.64029160739687, cost 400.80s 
-- test score: 0.51928211974941, cost 198.20s 
-- epoch 78 
-- finished epoch in 252.43s 
-- train score: 0.63531294452347, cost 400.96s 
-- test score: 0.51745917633768, cost 198.25s 
-- epoch 79 
-- finished epoch in 255.38s 
-- train score: 0.62920392196708, cost 392.25s 
-- test score: 0.51329978432782, cost 194.05s 
-- epoch 80 
-- finished epoch in 263.42s 
-- train score: 0.5735749847592, cost 393.70s 
-- test score: 0.47491527164424, cost 204.06s 
-- epoch 81 
-- finished epoch in 287.63s 
-- train score: 0.63747205852469, cost 419.42s 
-- test score: 0.51763890315292, cost 207.40s 
-- epoch 82 
-- finished epoch in 287.54s 
-- train score: 0.64447012802276, cost 418.72s 
-- test score: 0.52125911471706, cost 207.10s 
-- epoch 83 
-- finished epoch in 287.42s 
-- train score: 0.60716825848405, cost 419.47s 
-- test score: 0.49663654102906, cost 207.48s 
-- epoch 84 
-- finished epoch in 287.38s 
-- train score: 0.65377971956919, cost 419.78s 
-- test score: 0.52582931087604, cost 207.61s 
-- epoch 85 
-- finished epoch in 285.79s 
-- train score: 0.65803444421865, cost 404.82s 
-- test score: 0.52621443976584, cost 197.26s 
-- epoch 86 
-- finished epoch in 259.36s 
-- train score: 0.66049837431416, cost 400.54s 
-- test score: 0.5268049707302, cost 193.70s 
-- epoch 87 
-- finished epoch in 262.86s 
-- train score: 0.66767425320057, cost 401.73s 
-- test score: 0.53129814111123, cost 194.96s 
-- epoch 88 
-- finished epoch in 255.84s 
-- train score: 0.66653119284698, cost 394.71s 
-- test score: 0.52862791414193, cost 195.17s 
-- epoch 89 
-- finished epoch in 254.20s 
-- train score: 0.66391485470433, cost 394.87s 
-- test score: 0.52855088836397, cost 195.22s 
-- epoch 90 
-- finished epoch in 260.75s 
-- train score: 0.67204328388539, cost 398.91s 
-- test score: 0.52937249666222, cost 198.10s 
-- epoch 91 
-- finished epoch in 251.97s 
-- train score: 0.67050650274334, cost 400.74s 
-- test score: 0.53106706377734, cost 198.06s 
-- epoch 92 
-- finished epoch in 251.92s 
-- train score: 0.67211948790896, cost 400.84s 
-- test score: 0.52903871829105, cost 198.12s 
-- epoch 93 
-- finished epoch in 251.88s 
-- train score: 0.67598049176997, cost 400.63s 
-- test score: 0.53196569785355, cost 198.06s 
-- epoch 94 
-- finished epoch in 251.92s 
-- train score: 0.67318634423898, cost 400.40s 
-- test score: 0.53158056896375, cost 197.94s 
-- epoch 95 
-- finished epoch in 251.91s 
-- train score: 0.66983336720179, cost 400.57s 
-- test score: 0.52834548628941, cost 198.11s 
-- epoch 96 
-- finished epoch in 252.01s 
-- train score: 0.67180197114408, cost 400.61s 
-- test score: 0.52685632124884, cost 198.12s 
-- epoch 97 
-- finished epoch in 259.05s 
-- train score: 0.67732676285308, cost 400.22s 
-- test score: 0.53160624422307, cost 197.64s 
-- epoch 98 
-- finished epoch in 257.05s 
-- train score: 0.68478205649258, cost 400.55s 
-- test score: 0.53399404333984, cost 198.07s 
-- epoch 99 
-- finished epoch in 252.71s 
-- train score: 0.67933346880715, cost 402.21s 
-- test score: 0.53186299681627, cost 198.89s 
-- epoch 100 
-- finished epoch in 252.25s 
-- train score: 0.68353739077423, cost 402.45s 
-- test score: 0.53271028037383, cost 199.07s 
finished training in 86877.68s 
best dev score is: 0.53399404333984 
writing model to ./done/vqalstm-COCOQA-rnn_textonly.l1.d150.e98.c1-2016-01-16T164109.t7 
