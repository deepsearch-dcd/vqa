[program started on Mon Jan 25 20:59:45 2016] 
[command line arguments] 
[----------------------] 
-------------------------------------------------------------------------------- 
LSTM for VQA 
-------------------------------------------------------------------------------- 
loading COCOQA datasets 
Remove determiner done. 
loading features 
num train = 78736 
num test  = 38948 
-------------------------------------------------------------------------------- 
model configuration 
-------------------------------------------------------------------------------- 
max epochs                = 100 
num params                = 248830 
num compositional params  = 183900 
word vector dim           = 50 
LSTM memory dim           = 150 
LSTM structure            = rnn 
LSTM layers               = 1 
regularization strength   = 1.00e-04 
minibatch size            = 1 
learning rate             = 5.00e-02 
word vector learning rate = 1.00e-01 
dropout                   = true 
cuda                      = true 
image feature dim         = 1024 
-------------------------------------------------------------------------------- 
Training model 
-------------------------------------------------------------------------------- 
-- epoch 1 
-- finished epoch in 596.47s 
-- train score: 0.21192338955497, cost 637.77s 
-- test score: 0.20478586833727, cost 341.32s 
-- epoch 2 
-- finished epoch in 408.98s 
-- train score: 0.25328947368421, cost 656.95s 
-- test score: 0.24976892266612, cost 340.09s 
-- epoch 3 
-- finished epoch in 599.32s 
-- train score: 0.28831792318634, cost 697.22s 
-- test score: 0.27179829516278, cost 341.24s 
-- epoch 4 
-- finished epoch in 601.50s 
-- train score: 0.3387649867913, cost 705.85s 
-- test score: 0.31940022594228, cost 352.98s 
-- epoch 5 
-- finished epoch in 638.31s 
-- train score: 0.36086415362731, cost 702.86s 
-- test score: 0.33683372702064, cost 354.94s 
-- epoch 6 
-- finished epoch in 458.82s 
-- train score: 0.38805628937208, cost 594.73s 
-- test score: 0.35578206839889, cost 315.72s 
-- epoch 7 
-- finished epoch in 424.15s 
-- train score: 0.40701839057102, cost 580.02s 
-- test score: 0.37203450754853, cost 294.06s 
-- epoch 8 
-- finished epoch in 424.11s 
-- train score: 0.42158605974395, cost 594.60s 
-- test score: 0.38001951319708, cost 293.48s 
-- epoch 9 
-- finished epoch in 426.38s 
-- train score: 0.43645854501118, cost 592.46s 
-- test score: 0.38620725069323, cost 294.32s 
-- epoch 10 
-- finished epoch in 425.60s 
-- train score: 0.44513310302784, cost 592.52s 
-- test score: 0.3924206634487, cost 288.83s 
-- epoch 11 
-- finished epoch in 408.37s 
-- train score: 0.45650020321073, cost 592.18s 
-- test score: 0.39853137516689, cost 293.10s 
-- epoch 12 
-- finished epoch in 425.19s 
-- train score: 0.46474293842715, cost 591.77s 
-- test score: 0.40274211769539, cost 292.42s 
-- epoch 13 
-- finished epoch in 424.85s 
-- train score: 0.48016155252997, cost 591.83s 
-- test score: 0.40726096333573, cost 292.27s 
-- epoch 14 
-- finished epoch in 425.05s 
-- train score: 0.48426386913229, cost 581.60s 
-- test score: 0.40785149430009, cost 291.76s 
-- epoch 15 
-- finished epoch in 425.62s 
-- train score: 0.4980567973989, cost 591.31s 
-- test score: 0.40980281400842, cost 291.95s 
-- epoch 16 
-- finished epoch in 424.14s 
-- train score: 0.5013843730949, cost 592.17s 
-- test score: 0.41375680394372, cost 292.75s 
-- epoch 17 
-- finished epoch in 424.13s 
-- train score: 0.51266256858362, cost 591.07s 
-- test score: 0.41504056690973, cost 290.27s 
-- epoch 18 
-- finished epoch in 406.50s 
-- train score: 0.52326762853079, cost 591.51s 
-- test score: 0.4189688815857, cost 292.80s 
-- epoch 19 
-- finished epoch in 424.20s 
-- train score: 0.53215809794757, cost 592.08s 
-- test score: 0.42030399507035, cost 292.87s 
-- epoch 20 
-- finished epoch in 427.07s 
-- train score: 0.53778449502134, cost 590.98s 
-- test score: 0.42040669610763, cost 292.74s 
-- epoch 21 
-- finished epoch in 424.80s 
-- train score: 0.54850386100386, cost 582.01s 
-- test score: 0.42284584574304, cost 291.75s 
-- epoch 22 
-- finished epoch in 426.86s 
-- train score: 0.55195844340581, cost 594.41s 
-- test score: 0.42433501078361, cost 293.46s 
-- epoch 23 
-- finished epoch in 423.72s 
-- train score: 0.55886760820971, cost 593.84s 
-- test score: 0.42502824278525, cost 294.81s 
-- epoch 24 
-- finished epoch in 424.30s 
-- train score: 0.56676742532006, cost 591.64s 
-- test score: 0.42708226353086, cost 291.89s 
-- epoch 25 
-- finished epoch in 409.17s 
-- train score: 0.57760109733794, cost 592.19s 
-- test score: 0.42885385642395, cost 293.87s 
-- epoch 26 
-- finished epoch in 424.44s 
-- train score: 0.58369741922373, cost 592.69s 
-- test score: 0.42944438738831, cost 293.31s 
-- epoch 27 
-- finished epoch in 425.72s 
-- train score: 0.58796484454379, cost 592.52s 
-- test score: 0.43244839272877, cost 292.58s 
-- epoch 28 
-- finished epoch in 428.09s 
-- train score: 0.59370554765292, cost 583.55s 
-- test score: 0.42903358323919, cost 288.53s 
-- epoch 29 
-- finished epoch in 425.52s 
-- train score: 0.59632188579557, cost 595.33s 
-- test score: 0.43347540310157, cost 293.49s 
-- epoch 30 
-- finished epoch in 424.51s 
-- train score: 0.60768898597846, cost 596.83s 
-- test score: 0.43914963541132, cost 293.57s 
-- epoch 31 
-- finished epoch in 427.45s 
-- train score: 0.61583011583012, cost 592.47s 
-- test score: 0.44377118208894, cost 292.38s 
-- epoch 32 
-- finished epoch in 408.61s 
-- train score: 0.62040235724446, cost 593.01s 
-- test score: 0.45047242477149, cost 293.46s 
-- epoch 33 
-- finished epoch in 423.84s 
-- train score: 0.62701940662467, cost 594.53s 
-- test score: 0.45196158981206, cost 293.39s 
-- epoch 34 
-- finished epoch in 426.14s 
-- train score: 0.63960577118472, cost 594.24s 
-- test score: 0.45755879634384, cost 295.47s 
-- epoch 35 
-- finished epoch in 426.77s 
-- train score: 0.64736588091851, cost 585.79s 
-- test score: 0.46282222450447, cost 289.69s 
-- epoch 36 
-- finished epoch in 426.39s 
-- train score: 0.65602773826458, cost 591.73s 
-- test score: 0.46764917325665, cost 293.73s 
-- epoch 37 
-- finished epoch in 424.48s 
-- train score: 0.66018085754928, cost 594.47s 
-- test score: 0.47057615281914, cost 294.93s 
-- epoch 38 
-- finished epoch in 425.08s 
-- train score: 0.6706208087787, cost 593.79s 
-- test score: 0.47265584882407, cost 292.84s 
-- epoch 39 
-- finished epoch in 408.49s 
-- train score: 0.67432940459256, cost 583.29s 
-- test score: 0.47591660675773, cost 289.40s 
-- epoch 40 
-- finished epoch in 411.87s 
-- train score: 0.68333418004471, cost 591.12s 
-- test score: 0.47491527164424, cost 290.29s 
-- epoch 41 
-- finished epoch in 414.56s 
-- train score: 0.68095915464337, cost 585.45s 
-- test score: 0.47563417890521, cost 291.49s 
-- epoch 42 
-- finished epoch in 416.81s 
-- train score: 0.67653932127616, cost 585.68s 
-- test score: 0.47170586422923, cost 289.00s 
-- epoch 43 
-- finished epoch in 415.62s 
-- train score: 0.6924786628734, cost 590.42s 
-- test score: 0.47994762247099, cost 290.53s 
-- epoch 44 
-- finished epoch in 414.71s 
-- train score: 0.69833367201788, cost 587.74s 
-- test score: 0.48161651432679, cost 291.74s 
-- epoch 45 
-- finished epoch in 415.50s 
-- train score: 0.69070056899004, cost 586.88s 
-- test score: 0.4783044058745, cost 289.54s 
-- epoch 46 
-- finished epoch in 414.69s 
-- train score: 0.70063249339565, cost 588.45s 
-- test score: 0.48431241655541, cost 291.14s 
-- epoch 47 
-- finished epoch in 413.08s 
-- train score: 0.70152154033733, cost 584.50s 
-- test score: 0.48138543699291, cost 290.63s 
-- epoch 48 
-- finished epoch in 414.87s 
-- train score: 0.68203871164397, cost 585.89s 
-- test score: 0.46785457533121, cost 288.55s 
-- epoch 49 
-- finished epoch in 414.20s 
-- train score: 0.71403170087381, cost 587.38s 
-- test score: 0.48441511759269, cost 290.48s 
-- epoch 50 
-- finished epoch in 416.81s 
-- train score: 0.7181975208291, cost 586.53s 
-- test score: 0.48631508678238, cost 290.66s 
-- epoch 51 
-- finished epoch in 415.43s 
-- train score: 0.70002286120707, cost 586.76s 
-- test score: 0.4746071685324, cost 287.96s 
-- epoch 52 
-- finished epoch in 415.02s 
-- train score: 0.71796890875838, cost 588.16s 
-- test score: 0.48603265892986, cost 291.67s 
-- epoch 53 
-- finished epoch in 416.78s 
-- train score: 0.73116490550701, cost 586.35s 
-- test score: 0.48770155078566, cost 290.22s 
-- epoch 54 
-- finished epoch in 416.88s 
-- train score: 0.7336923389555, cost 588.87s 
-- test score: 0.48870288589915, cost 289.58s 
-- epoch 55 
-- finished epoch in 415.07s 
-- train score: 0.73568634423898, cost 588.20s 
-- test score: 0.48911369004827, cost 291.64s 
-- epoch 56 
-- finished epoch in 415.71s 
-- train score: 0.74274791709002, cost 587.09s 
-- test score: 0.49281092739037, cost 290.08s 
-- epoch 57 
-- finished epoch in 415.23s 
-- train score: 0.74295112781955, cost 587.62s 
-- test score: 0.48916504056691, cost 289.33s 
-- epoch 58 
-- finished epoch in 413.98s 
-- train score: 0.74039829302987, cost 588.08s 
-- test score: 0.48893396323303, cost 291.94s 
-- epoch 59 
-- finished epoch in 416.04s 
-- train score: 0.73370503962609, cost 584.80s 
-- test score: 0.48670021567218, cost 289.88s 
-- epoch 60 
-- finished epoch in 415.03s 
-- train score: 0.75011430603536, cost 590.19s 
-- test score: 0.49275957687173, cost 291.07s 
-- epoch 61 
-- finished epoch in 414.32s 
-- train score: 0.75265444015444, cost 584.91s 
-- test score: 0.49437711820889, cost 291.04s 
-- epoch 62 
-- finished epoch in 416.13s 
-- train score: 0.75742989229831, cost 585.71s 
-- test score: 0.49134743760912, cost 289.07s 
-- epoch 63 
-- finished epoch in 414.13s 
-- train score: 0.7574806949807, cost 589.99s 
-- test score: 0.49311903050221, cost 291.72s 
-- epoch 64 
-- finished epoch in 413.94s 
-- train score: 0.76258636456005, cost 583.86s 
-- test score: 0.49404333983773, cost 290.23s 
-- epoch 65 
-- finished epoch in 416.04s 
-- train score: 0.75979221702906, cost 588.24s 
-- test score: 0.49406901509705, cost 289.94s 
-- epoch 66 
-- finished epoch in 414.38s 
-- train score: 0.76875889046942, cost 586.63s 
-- test score: 0.49530142754442, cost 290.42s 
-- epoch 67 
-- finished epoch in 415.00s 
-- train score: 0.77542674253201, cost 585.52s 
-- test score: 0.4946338708021, cost 290.13s 
-- epoch 68 
-- finished epoch in 416.33s 
-- train score: 0.72993294045926, cost 587.34s 
-- test score: 0.47563417890521, cost 288.82s 
-- epoch 69 
-- finished epoch in 414.64s 
-- train score: 0.74560556797399, cost 586.90s 
-- test score: 0.48351648351648, cost 290.22s 
-- epoch 70 
-- finished epoch in 417.13s 
-- train score: 0.75758230034546, cost 585.48s 
-- test score: 0.48641778781966, cost 289.07s 
-- epoch 71 
-- finished epoch in 416.19s 
-- train score: 0.76656167445641, cost 587.87s 
-- test score: 0.48731642189586, cost 288.40s 
-- epoch 72 
-- finished epoch in 414.43s 
-- train score: 0.77127362324731, cost 586.35s 
-- test score: 0.48780425182294, cost 290.87s 
-- epoch 73 
-- finished epoch in 416.51s 
-- train score: 0.77306441780126, cost 584.15s 
-- test score: 0.48988394782787, cost 288.78s 
-- epoch 74 
-- finished epoch in 415.72s 
-- train score: 0.77479170900224, cost 588.40s 
-- test score: 0.48677724145014, cost 289.96s 
-- epoch 75 
-- finished epoch in 414.51s 
-- train score: 0.78196758788864, cost 585.70s 
-- test score: 0.49180959227688, cost 291.16s 
-- epoch 76 
-- finished epoch in 417.02s 
-- train score: 0.78608260516155, cost 584.80s 
-- test score: 0.491578514943, cost 288.61s 
-- epoch 77 
-- finished epoch in 414.62s 
-- train score: 0.78896565738671, cost 588.21s 
-- test score: 0.49291362842765, cost 290.58s 
-- epoch 78 
-- finished epoch in 414.32s 
-- train score: 0.78634931924406, cost 586.71s 
-- test score: 0.49460819554277, cost 291.77s 
-- epoch 79 
-- finished epoch in 415.59s 
-- train score: 0.79574781548466, cost 585.92s 
-- test score: 0.49329875731745, cost 288.90s 
-- epoch 80 
-- finished epoch in 414.81s 
-- train score: 0.79209002235318, cost 589.33s 
-- test score: 0.4954041285817, cost 291.28s 
-- epoch 81 
-- finished epoch in 414.43s 
-- train score: 0.79770371875635, cost 583.16s 
-- test score: 0.49548115435966, cost 289.46s 
-- epoch 82 
-- finished epoch in 415.57s 
-- train score: 0.79764021540337, cost 588.15s 
-- test score: 0.4947622470987, cost 289.77s 
-- epoch 83 
-- finished epoch in 414.37s 
-- train score: 0.79466825848405, cost 586.09s 
-- test score: 0.49350415939201, cost 290.15s 
-- epoch 84 
-- finished epoch in 415.29s 
-- train score: 0.80133611054664, cost 584.08s 
-- test score: 0.49612303584266, cost 288.91s 
-- epoch 85 
-- finished epoch in 416.61s 
-- train score: 0.80490499898395, cost 587.00s 
-- test score: 0.49293930368697, cost 288.30s 
-- epoch 86 
-- finished epoch in 414.39s 
-- train score: 0.7939697216013, cost 586.42s 
-- test score: 0.49391496354113, cost 290.40s 
-- epoch 87 
-- finished epoch in 415.76s 
-- train score: 0.80611156269051, cost 584.09s 
-- test score: 0.49481359761734, cost 289.95s 
-- epoch 88 
-- finished epoch in 415.32s 
-- train score: 0.80933753302174, cost 587.18s 
-- test score: 0.4963027626579, cost 288.68s 
-- epoch 89 
-- finished epoch in 414.18s 
-- train score: 0.8133382442593, cost 585.84s 
-- test score: 0.49517305124782, cost 290.35s 
-- epoch 90 
-- finished epoch in 415.35s 
-- train score: 0.8180374923796, cost 585.65s 
-- test score: 0.49388928828181, cost 289.20s 
-- epoch 91 
-- finished epoch in 415.29s 
-- train score: 0.81794858768543, cost 588.34s 
-- test score: 0.49496764917326, cost 290.20s 
-- epoch 92 
-- finished epoch in 415.76s 
-- train score: 0.81811369640317, cost 585.08s 
-- test score: 0.49522440176646, cost 290.38s 
-- epoch 93 
-- finished epoch in 415.74s 
-- train score: 0.82338447470026, cost 587.15s 
-- test score: 0.49653383999178, cost 292.32s 
-- epoch 94 
-- finished epoch in 430.05s 
-- train score: 0.82423541963016, cost 589.93s 
-- test score: 0.4966878915477, cost 291.14s 
-- epoch 95 
-- finished epoch in 565.97s 
-- train score: 0.81262700670595, cost 626.23s 
-- test score: 0.49504467495122, cost 290.46s 
-- epoch 96 
-- finished epoch in 416.51s 
-- train score: 0.82640723430197, cost 584.86s 
-- test score: 0.49707302043751, cost 288.99s 
-- epoch 97 
-- finished epoch in 415.56s 
-- train score: 0.81752946555578, cost 591.30s 
-- test score: 0.49396631405977, cost 291.90s 
-- epoch 98 
-- finished epoch in 414.47s 
-- train score: 0.82774080471449, cost 584.28s 
-- test score: 0.49573790695286, cost 290.84s 
-- epoch 99 
-- finished epoch in 417.29s 
-- train score: 0.82593730948994, cost 586.98s 
-- test score: 0.49614871110198, cost 288.88s 
-- epoch 100 
-- finished epoch in 414.97s 
-- train score: 0.83108108108108, cost 590.85s 
-- test score: 0.49517305124782, cost 292.44s 
finished training in 131498.92s 
best dev score is: 0.49707302043751 
writing model to ./done/vqalstm-COCOQA-rnn.l1.d150.e96.c1-2016-01-27T093202.t7 
