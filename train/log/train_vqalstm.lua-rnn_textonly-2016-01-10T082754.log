[program started on Sun Jan 10 08:27:54 2016] 
[command line arguments] 
[----------------------] 
-------------------------------------------------------------------------------- 
LSTM for VQA with text only 
-------------------------------------------------------------------------------- 
loading COCOQA datasets 
Append captions with question done. 
Remove determiner done. 
num train = 78736 
num test  = 38948 
-------------------------------------------------------------------------------- 
model configuration 
-------------------------------------------------------------------------------- 
max epochs                = 100 
num params                = 95230 
num compositional params  = 30300 
word vector dim           = 50 
LSTM memory dim           = 150 
LSTM structure            = rnn 
LSTM layers               = 1 
regularization strength   = 1.00e-04 
minibatch size            = 1 
learning rate             = 5.00e-02 
word vector learning rate = 1.00e-01 
dropout                   = true 
cuda                      = true 
image feature dim         = [text only] 
-------------------------------------------------------------------------------- 
Training model 
-------------------------------------------------------------------------------- 
-- epoch 1 
-- finished epoch in 265.37s 
-- train score: 0.094492989229831, cost 394.78s 
-- test score: 0.093663345999795, cost 197.25s 
-- epoch 2 
-- finished epoch in 252.91s 
-- train score: 0.17192897785003, cost 385.73s 
-- test score: 0.16198521105063, cost 192.12s 
-- epoch 3 
-- finished epoch in 262.58s 
-- train score: 0.21823562284089, cost 386.51s 
-- test score: 0.20658313648968, cost 191.17s 
-- epoch 4 
-- finished epoch in 258.48s 
-- train score: 0.24284952245479, cost 387.50s 
-- test score: 0.22835575639314, cost 191.62s 
-- epoch 5 
-- finished epoch in 251.85s 
-- train score: 0.28154846575899, cost 387.24s 
-- test score: 0.2673564753004, cost 191.52s 
-- epoch 6 
-- finished epoch in 251.33s 
-- train score: 0.29074375127007, cost 387.53s 
-- test score: 0.27082263530862, cost 191.65s 
-- epoch 7 
-- finished epoch in 251.95s 
-- train score: 0.3304714488925, cost 387.73s 
-- test score: 0.30553558590942, cost 191.81s 
-- epoch 8 
-- finished epoch in 251.57s 
-- train score: 0.35297703718756, cost 387.44s 
-- test score: 0.32710280373832, cost 193.05s 
-- epoch 9 
-- finished epoch in 251.87s 
-- train score: 0.37425066043487, cost 389.49s 
-- test score: 0.34245660881175, cost 193.42s 
-- epoch 10 
-- finished epoch in 253.46s 
-- train score: 0.37135490753912, cost 400.49s 
-- test score: 0.34307281503543, cost 193.44s 
-- epoch 11 
-- finished epoch in 251.31s 
-- train score: 0.39786120707173, cost 391.25s 
-- test score: 0.36081441922563, cost 193.47s 
-- epoch 12 
-- finished epoch in 250.88s 
-- train score: 0.41763615118878, cost 391.11s 
-- test score: 0.37814521926671, cost 193.49s 
-- epoch 13 
-- finished epoch in 251.78s 
-- train score: 0.42059540743751, cost 391.08s 
-- test score: 0.37983978638184, cost 193.39s 
-- epoch 14 
-- finished epoch in 250.88s 
-- train score: 0.42786019101809, cost 391.27s 
-- test score: 0.38625860121187, cost 193.45s 
-- epoch 15 
-- finished epoch in 250.90s 
-- train score: 0.44529821174558, cost 391.14s 
-- test score: 0.39940433398377, cost 193.49s 
-- epoch 16 
-- finished epoch in 250.72s 
-- train score: 0.44514580369844, cost 391.24s 
-- test score: 0.39850569990757, cost 193.50s 
-- epoch 17 
-- finished epoch in 251.16s 
-- train score: 0.4325213371266, cost 391.81s 
-- test score: 0.38697750847284, cost 193.43s 
-- epoch 18 
-- finished epoch in 254.48s 
-- train score: 0.45972617354196, cost 391.79s 
-- test score: 0.41044469549142, cost 193.68s 
-- epoch 19 
-- finished epoch in 251.06s 
-- train score: 0.47271895956106, cost 391.87s 
-- test score: 0.41955941255007, cost 193.69s 
-- epoch 20 
-- finished epoch in 251.36s 
-- train score: 0.47975513107092, cost 391.82s 
-- test score: 0.42312827359556, cost 193.75s 
-- epoch 21 
-- finished epoch in 251.11s 
-- train score: 0.48238416988417, cost 391.67s 
-- test score: 0.42767279449522, cost 193.66s 
-- epoch 22 
-- finished epoch in 251.15s 
-- train score: 0.47480186953871, cost 391.80s 
-- test score: 0.42109992810927, cost 193.73s 
-- epoch 23 
-- finished epoch in 251.20s 
-- train score: 0.49229069294859, cost 391.73s 
-- test score: 0.43221731539489, cost 193.78s 
-- epoch 24 
-- finished epoch in 253.84s 
-- train score: 0.49521184718553, cost 395.55s 
-- test score: 0.43468214028962, cost 195.03s 
-- epoch 25 
-- finished epoch in 254.26s 
-- train score: 0.49907285104654, cost 393.97s 
-- test score: 0.43719831570299, cost 194.86s 
-- epoch 26 
-- finished epoch in 255.09s 
-- train score: 0.50158758382443, cost 393.95s 
-- test score: 0.43565780014378, cost 194.89s 
-- epoch 27 
-- finished epoch in 254.27s 
-- train score: 0.50803952448689, cost 393.95s 
-- test score: 0.43968881585704, cost 194.86s 
-- epoch 28 
-- finished epoch in 254.27s 
-- train score: 0.51926691729323, cost 394.05s 
-- test score: 0.44993324432577, cost 194.88s 
-- epoch 29 
-- finished epoch in 255.70s 
-- train score: 0.52171814671815, cost 393.91s 
-- test score: 0.4535534558899, cost 194.82s 
-- epoch 30 
-- finished epoch in 256.01s 
-- train score: 0.49349725665515, cost 399.86s 
-- test score: 0.43000924309336, cost 193.47s 
-- epoch 31 
-- finished epoch in 252.07s 
-- train score: 0.51910180857549, cost 391.04s 
-- test score: 0.44967649173257, cost 193.49s 
-- epoch 32 
-- finished epoch in 252.02s 
-- train score: 0.50257823613087, cost 391.28s 
-- test score: 0.43732669199959, cost 193.47s 
-- epoch 33 
-- finished epoch in 252.36s 
-- train score: 0.52443609022556, cost 390.99s 
-- test score: 0.45381020848311, cost 193.30s 
-- epoch 34 
-- finished epoch in 252.24s 
-- train score: 0.52984657589921, cost 390.95s 
-- test score: 0.45812365204889, cost 193.39s 
-- epoch 35 
-- finished epoch in 252.40s 
-- train score: 0.53735267222109, cost 391.15s 
-- test score: 0.46354113176543, cost 193.36s 
-- epoch 36 
-- finished epoch in 252.23s 
-- train score: 0.54746240601504, cost 390.99s 
-- test score: 0.4697545445209, cost 193.40s 
-- epoch 37 
-- finished epoch in 257.99s 
-- train score: 0.54821174558017, cost 390.78s 
-- test score: 0.47170586422923, cost 193.15s 
-- epoch 38 
-- finished epoch in 251.99s 
-- train score: 0.55175523267629, cost 390.67s 
-- test score: 0.47198829208175, cost 197.17s 
-- epoch 39 
-- finished epoch in 251.96s 
-- train score: 0.55105669579354, cost 389.29s 
-- test score: 0.47401663756804, cost 192.48s 
-- epoch 40 
-- finished epoch in 251.42s 
-- train score: 0.56322393822394, cost 389.23s 
-- test score: 0.48128273595563, cost 192.53s 
-- epoch 41 
-- finished epoch in 251.35s 
-- train score: 0.56289372078846, cost 389.34s 
-- test score: 0.482515148403, cost 192.52s 
-- epoch 42 
-- finished epoch in 251.35s 
-- train score: 0.49728205649258, cost 388.93s 
-- test score: 0.43314162473041, cost 192.41s 
-- epoch 43 
-- finished epoch in 251.80s 
-- train score: 0.53827982117456, cost 389.61s 
-- test score: 0.46420868850775, cost 192.68s 
-- epoch 44 
-- finished epoch in 251.66s 
-- train score: 0.51233235114814, cost 388.88s 
-- test score: 0.44649275957687, cost 192.27s 
-- epoch 45 
-- finished epoch in 251.90s 
-- train score: 0.54520168664906, cost 388.96s 
-- test score: 0.46916401355654, cost 192.37s 
-- epoch 46 
-- finished epoch in 251.90s 
-- train score: 0.54405862629547, cost 388.93s 
-- test score: 0.46721269384821, cost 192.42s 
-- epoch 47 
-- finished epoch in 252.38s 
-- train score: 0.54991363543995, cost 398.62s 
-- test score: 0.47514634897812, cost 199.49s 
-- epoch 48 
-- finished epoch in 258.10s 
-- train score: 0.55324121113595, cost 399.41s 
-- test score: 0.47635308616617, cost 192.63s 
-- epoch 49 
-- finished epoch in 251.23s 
-- train score: 0.55628937207885, cost 389.42s 
-- test score: 0.47594228201705, cost 192.54s 
-- epoch 50 
-- finished epoch in 251.50s 
-- train score: 0.56397327778907, cost 389.40s 
-- test score: 0.483798911369, cost 192.61s 
-- epoch 51 
-- finished epoch in 250.81s 
-- train score: 0.56923135541557, cost 389.47s 
-- test score: 0.48469754544521, cost 194.72s 
-- epoch 52 
-- finished epoch in 251.00s 
-- train score: 0.55927402966877, cost 389.45s 
-- test score: 0.48325973092328, cost 192.65s 
-- epoch 53 
-- finished epoch in 251.16s 
-- train score: 0.55167902865271, cost 389.45s 
-- test score: 0.474735544829, cost 192.59s 
-- epoch 54 
-- finished epoch in 251.35s 
-- train score: 0.57131426539321, cost 389.44s 
-- test score: 0.48554482900277, cost 192.68s 
-- epoch 55 
-- finished epoch in 251.35s 
-- train score: 0.55453667953668, cost 389.28s 
-- test score: 0.47755982335422, cost 192.48s 
-- epoch 56 
-- finished epoch in 257.09s 
-- train score: 0.56368116236537, cost 389.12s 
-- test score: 0.48418404025881, cost 192.52s 
-- epoch 57 
-- finished epoch in 251.44s 
-- train score: 0.5763183296078, cost 389.23s 
-- test score: 0.49291362842765, cost 192.39s 
-- epoch 58 
-- finished epoch in 251.37s 
-- train score: 0.57981101402154, cost 388.99s 
-- test score: 0.49355550991065, cost 192.39s 
-- epoch 59 
-- finished epoch in 251.12s 
-- train score: 0.57984911603333, cost 389.80s 
-- test score: 0.48960151997535, cost 192.76s 
-- epoch 60 
-- finished epoch in 251.56s 
-- train score: 0.58199552936395, cost 389.25s 
-- test score: 0.49011502516175, cost 192.50s 
-- epoch 61 
-- finished epoch in 251.48s 
-- train score: 0.59064468603942, cost 389.39s 
-- test score: 0.49699599465955, cost 192.49s 
-- epoch 62 
-- finished epoch in 251.32s 
-- train score: 0.59436598252388, cost 389.52s 
-- test score: 0.50097565985416, cost 192.65s 
-- epoch 63 
-- finished epoch in 251.53s 
-- train score: 0.59689341597236, cost 389.39s 
-- test score: 0.50151484029989, cost 192.53s 
-- epoch 64 
-- finished epoch in 251.35s 
-- train score: 0.59294350741719, cost 390.77s 
-- test score: 0.49468522132074, cost 193.00s 
-- epoch 65 
-- finished epoch in 251.62s 
-- train score: 0.59611867506604, cost 390.27s 
-- test score: 0.49725274725275, cost 192.96s 
-- epoch 66 
-- finished epoch in 251.15s 
-- train score: 0.56548465758992, cost 390.25s 
-- test score: 0.47838143165246, cost 192.94s 
-- epoch 67 
-- finished epoch in 254.53s 
-- train score: 0.58232574679943, cost 389.45s 
-- test score: 0.49219472116668, cost 192.59s 
-- epoch 68 
-- finished epoch in 251.24s 
-- train score: 0.54048973785816, cost 389.39s 
-- test score: 0.45863715723529, cost 192.57s 
-- epoch 69 
-- finished epoch in 253.83s 
-- train score: 0.58569142450721, cost 391.48s 
-- test score: 0.49355550991065, cost 193.56s 
-- epoch 70 
-- finished epoch in 252.77s 
-- train score: 0.58504369030685, cost 391.39s 
-- test score: 0.49240012324124, cost 193.61s 
-- epoch 71 
-- finished epoch in 252.96s 
-- train score: 0.59797297297297, cost 391.39s 
-- test score: 0.50205402074561, cost 193.50s 
-- epoch 72 
-- finished epoch in 252.59s 
-- train score: 0.60090682788051, cost 391.67s 
-- test score: 0.50187429393037, cost 193.72s 
-- epoch 73 
-- finished epoch in 253.02s 
-- train score: 0.60215149359886, cost 392.18s 
-- test score: 0.49989729896272, cost 193.86s 
-- epoch 74 
-- finished epoch in 254.14s 
-- train score: 0.59696961999594, cost 389.65s 
-- test score: 0.50005135051864, cost 192.76s 
-- epoch 75 
-- finished epoch in 251.61s 
-- train score: 0.60123704531599, cost 389.74s 
-- test score: 0.50115538666941, cost 192.62s 
-- epoch 76 
-- finished epoch in 251.17s 
-- train score: 0.60945437919122, cost 389.69s 
-- test score: 0.5051093766047, cost 192.78s 
-- epoch 77 
-- finished epoch in 251.09s 
-- train score: 0.60969569193253, cost 389.45s 
-- test score: 0.50377426312006, cost 192.58s 
-- epoch 78 
-- finished epoch in 251.26s 
-- train score: 0.60036069904491, cost 389.55s 
-- test score: 0.49992297422204, cost 192.63s 
-- epoch 79 
-- finished epoch in 251.21s 
-- train score: 0.60955598455598, cost 389.54s 
-- test score: 0.50362021156414, cost 192.56s 
-- epoch 80 
-- finished epoch in 251.37s 
-- train score: 0.6042471042471, cost 389.45s 
-- test score: 0.49845948444079, cost 192.62s 
-- epoch 81 
-- finished epoch in 251.23s 
-- train score: 0.61595712253607, cost 389.48s 
-- test score: 0.50736879942487, cost 193.77s 
-- epoch 82 
-- finished epoch in 251.62s 
-- train score: 0.62110089412721, cost 390.60s 
-- test score: 0.50875526342816, cost 193.14s 
-- epoch 83 
-- finished epoch in 251.20s 
-- train score: 0.62390774232879, cost 390.84s 
-- test score: 0.51024442846873, cost 193.20s 
-- epoch 84 
-- finished epoch in 251.32s 
-- train score: 0.61990703109124, cost 390.15s 
-- test score: 0.5047242477149, cost 192.95s 
-- epoch 85 
-- finished epoch in 251.35s 
-- train score: 0.62525401341191, cost 390.22s 
-- test score: 0.51147684091609, cost 192.95s 
-- epoch 86 
-- finished epoch in 251.25s 
-- train score: 0.62644787644788, cost 390.41s 
-- test score: 0.51270925336346, cost 192.93s 
-- epoch 87 
-- finished epoch in 251.31s 
-- train score: 0.62635897175371, cost 390.37s 
-- test score: 0.51011605217213, cost 193.00s 
-- epoch 88 
-- finished epoch in 251.45s 
-- train score: 0.62972464946149, cost 390.22s 
-- test score: 0.51252952654822, cost 193.01s 
-- epoch 89 
-- finished epoch in 251.41s 
-- train score: 0.6277687461898, cost 390.22s 
-- test score: 0.51168224299065, cost 192.97s 
-- epoch 90 
-- finished epoch in 254.49s 
-- train score: 0.63564316195895, cost 392.93s 
-- test score: 0.51494300092431, cost 192.77s 
-- epoch 91 
-- finished epoch in 252.64s 
-- train score: 0.63512243446454, cost 390.47s 
-- test score: 0.51640649070556, cost 193.08s 
-- epoch 92 
-- finished epoch in 251.20s 
-- train score: 0.63702753505385, cost 390.18s 
-- test score: 0.5131457327719, cost 193.03s 
-- epoch 93 
-- finished epoch in 251.46s 
-- train score: 0.63781497663077, cost 390.23s 
-- test score: 0.51484029988703, cost 192.91s 
-- epoch 94 
-- finished epoch in 251.48s 
-- train score: 0.64205700060963, cost 390.21s 
-- test score: 0.51738215055972, cost 197.37s 
-- epoch 95 
-- finished epoch in 255.86s 
-- train score: 0.64114255232676, cost 398.81s 
-- test score: 0.51604703707507, cost 193.30s 
-- epoch 96 
-- finished epoch in 251.50s 
-- train score: 0.64251422475107, cost 398.33s 
-- test score: 0.51404436684811, cost 390.64s 
-- epoch 97 
-- finished epoch in 434.44s 
-- train score: 0.64234911603333, cost 598.10s 
-- test score: 0.51419841840403, cost 309.48s 
-- epoch 98 
-- finished epoch in 507.37s 
-- train score: 0.62366642958748, cost 665.37s 
-- test score: 0.50415939200986, cost 297.37s 
-- epoch 99 
-- finished epoch in 378.69s 
-- train score: 0.6391104450315, cost 776.15s 
-- test score: 0.51466057307179, cost 297.16s 
-- epoch 100 
-- finished epoch in 294.30s 
-- train score: 0.64582909977647, cost 841.37s 
-- test score: 0.51704837218856, cost 297.54s 
finished training in 86225.01s 
best dev score is: 0.51738215055972 
writing model to ./done/vqalstm-COCOQA-rnn_textonly.l1.d150.e94.c1-2016-01-11T082507.t7 
