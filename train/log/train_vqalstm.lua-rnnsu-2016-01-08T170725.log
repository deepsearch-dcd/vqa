[program started on Fri Jan  8 17:07:25 2016] 
[command line arguments] 
[----------------------] 
-------------------------------------------------------------------------------- 
LSTM for VQA 
-------------------------------------------------------------------------------- 
loading COCOQA datasets 
Remove determiner done. 
loading features 
num train = 78736 
num test  = 38948 
-------------------------------------------------------------------------------- 
model configuration 
-------------------------------------------------------------------------------- 
max epochs                = 100 
num params                = 226180 
num compositional params  = 161250 
word vector dim           = 50 
LSTM memory dim           = 150 
LSTM structure            = rnnsu 
LSTM layers               = 1 
regularization strength   = 1.00e-04 
minibatch size            = 1 
learning rate             = 5.00e-02 
word vector learning rate = 1.00e-01 
dropout                   = true 
cuda                      = true 
image feature dim         = 1024 
-------------------------------------------------------------------------------- 
Training model 
-------------------------------------------------------------------------------- 
-- epoch 1 
-- finished epoch in 165.06s 
-- train score: 0.16626447876448, cost 373.87s 
-- test score: 0.16686351032145, cost 180.97s 
-- epoch 2 
-- finished epoch in 154.66s 
-- train score: 0.21166937614306, cost 372.60s 
-- test score: 0.21166683783506, cost 186.10s 
-- epoch 3 
-- finished epoch in 155.70s 
-- train score: 0.23996647022963, cost 372.08s 
-- test score: 0.23444079285201, cost 185.26s 
-- epoch 4 
-- finished epoch in 157.06s 
-- train score: 0.26545671611461, cost 369.69s 
-- test score: 0.26073225839581, cost 180.24s 
-- epoch 5 
-- finished epoch in 155.55s 
-- train score: 0.28753048160943, cost 366.19s 
-- test score: 0.27734415117593, cost 181.22s 
-- epoch 6 
-- finished epoch in 149.40s 
-- train score: 0.31224598658809, cost 370.96s 
-- test score: 0.30070863715724, cost 181.18s 
-- epoch 7 
-- finished epoch in 155.01s 
-- train score: 0.33249085551717, cost 363.82s 
-- test score: 0.31544623600698, cost 182.94s 
-- epoch 8 
-- finished epoch in 152.04s 
-- train score: 0.34576305628937, cost 369.71s 
-- test score: 0.32517715928931, cost 186.70s 
-- epoch 9 
-- finished epoch in 157.34s 
-- train score: 0.35814621011989, cost 379.44s 
-- test score: 0.33087706685838, cost 186.42s 
-- epoch 10 
-- finished epoch in 159.79s 
-- train score: 0.37390774232879, cost 376.98s 
-- test score: 0.34063366540002, cost 182.48s 
-- epoch 11 
-- finished epoch in 152.73s 
-- train score: 0.38234098760415, cost 378.16s 
-- test score: 0.34497278422512, cost 186.74s 
-- epoch 12 
-- finished epoch in 157.10s 
-- train score: 0.39238721804511, cost 374.29s 
-- test score: 0.35121187223991, cost 187.29s 
-- epoch 13 
-- finished epoch in 154.74s 
-- train score: 0.403220890063, cost 367.20s 
-- test score: 0.35465235698881, cost 181.44s 
-- epoch 14 
-- finished epoch in 157.13s 
-- train score: 0.41301310709205, cost 368.18s 
-- test score: 0.36335626989833, cost 180.45s 
-- epoch 15 
-- finished epoch in 149.50s 
-- train score: 0.42205598455598, cost 368.79s 
-- test score: 0.36571839375578, cost 186.25s 
-- epoch 16 
-- finished epoch in 151.43s 
-- train score: 0.43009550904288, cost 368.44s 
-- test score: 0.37013453835884, cost 181.25s 
-- epoch 17 
-- finished epoch in 148.85s 
-- train score: 0.4372205852469, cost 367.81s 
-- test score: 0.37349799732977, cost 182.09s 
-- epoch 18 
-- finished epoch in 151.64s 
-- train score: 0.44795265190002, cost 371.48s 
-- test score: 0.37917222963952, cost 186.49s 
-- epoch 19 
-- finished epoch in 157.26s 
-- train score: 0.45153424100793, cost 372.56s 
-- test score: 0.38043031734621, cost 179.61s 
-- epoch 20 
-- finished epoch in 149.03s 
-- train score: 0.45883712660028, cost 365.37s 
-- test score: 0.3839991783917, cost 181.57s 
-- epoch 21 
-- finished epoch in 154.26s 
-- train score: 0.46619081487503, cost 368.55s 
-- test score: 0.38507753928315, cost 180.12s 
-- epoch 22 
-- finished epoch in 159.79s 
-- train score: 0.47513208697419, cost 365.77s 
-- test score: 0.38949368388621, cost 180.29s 
-- epoch 23 
-- finished epoch in 159.17s 
-- train score: 0.48047906929486, cost 375.44s 
-- test score: 0.39044366848105, cost 186.51s 
-- epoch 24 
-- finished epoch in 158.17s 
-- train score: 0.48613086770982, cost 374.53s 
-- test score: 0.39501386464003, cost 187.72s 
-- epoch 25 
-- finished epoch in 159.83s 
-- train score: 0.49150325137167, cost 377.75s 
-- test score: 0.39529629249255, cost 187.37s 
-- epoch 26 
-- finished epoch in 156.03s 
-- train score: 0.49898394635237, cost 373.82s 
-- test score: 0.39776111738729, cost 181.50s 
-- epoch 27 
-- finished epoch in 155.07s 
-- train score: 0.50321326966064, cost 368.69s 
-- test score: 0.39796651946185, cost 181.45s 
-- epoch 28 
-- finished epoch in 151.42s 
-- train score: 0.5069218654745, cost 364.42s 
-- test score: 0.40145835472938, cost 185.35s 
-- epoch 29 
-- finished epoch in 161.01s 
-- train score: 0.51450416581996, cost 365.80s 
-- test score: 0.40238266406491, cost 181.43s 
-- epoch 30 
-- finished epoch in 156.56s 
-- train score: 0.51823816297501, cost 364.43s 
-- test score: 0.40240833932423, cost 180.36s 
-- epoch 31 
-- finished epoch in 153.25s 
-- train score: 0.52526163381427, cost 377.33s 
-- test score: 0.4059515251104, cost 184.73s 
-- epoch 32 
-- finished epoch in 158.73s 
-- train score: 0.53084992887624, cost 365.79s 
-- test score: 0.40831364896785, cost 180.65s 
-- epoch 33 
-- finished epoch in 153.63s 
-- train score: 0.53443151798415, cost 368.90s 
-- test score: 0.40736366437301, cost 180.21s 
-- epoch 34 
-- finished epoch in 158.15s 
-- train score: 0.54074375127007, cost 377.44s 
-- test score: 0.40700421074253, cost 185.03s 
-- epoch 35 
-- finished epoch in 160.04s 
-- train score: 0.54352519813046, cost 366.66s 
-- test score: 0.40854472630174, cost 185.91s 
-- epoch 36 
-- finished epoch in 152.90s 
-- train score: 0.54638284901443, cost 367.04s 
-- test score: 0.41124062853035, cost 181.05s 
-- epoch 37 
-- finished epoch in 150.28s 
-- train score: 0.55242836821784, cost 377.96s 
-- test score: 0.41057307178803, cost 180.77s 
-- epoch 38 
-- finished epoch in 149.76s 
-- train score: 0.55670849420849, cost 365.71s 
-- test score: 0.41136900482695, cost 180.70s 
-- epoch 39 
-- finished epoch in 153.60s 
-- train score: 0.56073460678724, cost 374.38s 
-- test score: 0.41260141727431, cost 185.87s 
-- epoch 40 
-- finished epoch in 149.40s 
-- train score: 0.56317313554156, cost 365.38s 
-- test score: 0.41396220601828, cost 180.68s 
-- epoch 41 
-- finished epoch in 158.11s 
-- train score: 0.56760566957935, cost 367.07s 
-- test score: 0.41419328335216, cost 181.31s 
-- epoch 42 
-- finished epoch in 152.28s 
-- train score: 0.5699806949807, cost 364.77s 
-- test score: 0.41457841224196, cost 180.48s 
-- epoch 43 
-- finished epoch in 156.34s 
-- train score: 0.5749466571835, cost 366.56s 
-- test score: 0.41540002054021, cost 181.93s 
-- epoch 44 
-- finished epoch in 150.69s 
-- train score: 0.57871875635034, cost 374.95s 
-- test score: 0.41545137105885, cost 186.59s 
-- epoch 45 
-- finished epoch in 159.80s 
-- train score: 0.57866795366795, cost 377.12s 
-- test score: 0.41629865461641, cost 186.41s 
-- epoch 46 
-- finished epoch in 159.80s 
-- train score: 0.5873806136964, cost 369.06s 
-- test score: 0.41968778884667, cost 180.47s 
-- epoch 47 
-- finished epoch in 159.71s 
-- train score: 0.58818075594391, cost 369.34s 
-- test score: 0.4175567423231, cost 180.13s 
-- epoch 48 
-- finished epoch in 153.58s 
-- train score: 0.59227037187564, cost 376.75s 
-- test score: 0.41624730409777, cost 186.08s 
-- epoch 49 
-- finished epoch in 159.77s 
-- train score: 0.59780786425523, cost 365.05s 
-- test score: 0.41804457225018, cost 180.15s 
-- epoch 50 
-- finished epoch in 155.14s 
-- train score: 0.5992811420443, cost 366.88s 
-- test score: 0.41635000513505, cost 180.13s 
-- epoch 51 
-- finished epoch in 157.05s 
-- train score: 0.60138945336314, cost 366.13s 
-- test score: 0.41799322173154, cost 181.81s 
-- epoch 52 
-- finished epoch in 150.66s 
-- train score: 0.6048186344239, cost 366.40s 
-- test score: 0.41719728869262, cost 180.30s 
-- epoch 53 
-- finished epoch in 153.05s 
-- train score: 0.60767628530786, cost 364.87s 
-- test score: 0.4185837526959, cost 180.36s 
-- epoch 54 
-- finished epoch in 158.24s 
-- train score: 0.60900985572038, cost 375.81s 
-- test score: 0.41791619595358, cost 183.14s 
-- epoch 55 
-- finished epoch in 155.34s 
-- train score: 0.61160079252185, cost 370.35s 
-- test score: 0.41919995891959, cost 181.79s 
-- epoch 56 
-- finished epoch in 159.56s 
-- train score: 0.61925929689088, cost 372.43s 
-- test score: 0.4179418712129, cost 180.03s 
-- epoch 57 
-- finished epoch in 153.06s 
-- train score: 0.61917039219671, cost 367.05s 
-- test score: 0.41740269076718, cost 180.40s 
-- epoch 58 
-- finished epoch in 161.26s 
-- train score: 0.62369183092867, cost 366.92s 
-- test score: 0.4187121289925, cost 180.81s 
-- epoch 59 
-- finished epoch in 152.97s 
-- train score: 0.6261049583418, cost 365.16s 
-- test score: 0.41991886618055, cost 181.35s 
-- epoch 60 
-- finished epoch in 156.03s 
-- train score: 0.63067719975615, cost 359.82s 
-- test score: 0.41945671151279, cost 176.08s 
-- epoch 61 
-- finished epoch in 147.43s 
-- train score: 0.6316297500508, cost 362.01s 
-- test score: 0.41917428366026, cost 176.05s 
-- epoch 62 
-- finished epoch in 145.52s 
-- train score: 0.63378886405202, cost 356.00s 
-- test score: 0.41837835062134, cost 180.39s 
-- epoch 63 
-- finished epoch in 145.38s 
-- train score: 0.6368878276773, cost 360.56s 
-- test score: 0.42084317551607, cost 184.09s 
-- epoch 64 
-- finished epoch in 144.93s 
-- train score: 0.63996138996139, cost 358.13s 
-- test score: 0.41863510321454, cost 175.90s 
-- epoch 65 
-- finished epoch in 144.66s 
-- train score: 0.63861511887828, cost 361.96s 
-- test score: 0.41881483002978, cost 176.01s 
-- epoch 66 
-- finished epoch in 144.76s 
-- train score: 0.64204429993904, cost 356.59s 
-- test score: 0.41925130943823, cost 176.09s 
-- epoch 67 
-- finished epoch in 144.79s 
-- train score: 0.64673084738874, cost 356.14s 
-- test score: 0.41789052069426, cost 175.93s 
-- epoch 68 
-- finished epoch in 147.45s 
-- train score: 0.6443558219874, cost 358.47s 
-- test score: 0.42050939714491, cost 179.73s 
-- epoch 69 
-- finished epoch in 145.87s 
-- train score: 0.65399563096932, cost 366.33s 
-- test score: 0.41919995891959, cost 181.29s 
-- epoch 70 
-- finished epoch in 154.76s 
-- train score: 0.6537670188986, cost 365.00s 
-- test score: 0.41894320632638, cost 183.55s 
-- epoch 71 
-- finished epoch in 156.15s 
-- train score: 0.65558321479374, cost 362.17s 
-- test score: 0.42061209818219, cost 180.03s 
-- epoch 72 
-- finished epoch in 154.45s 
-- train score: 0.65826305628937, cost 362.98s 
-- test score: 0.4179418712129, cost 175.81s 
-- epoch 73 
-- finished epoch in 145.05s 
-- train score: 0.66054917699655, cost 355.53s 
-- test score: 0.42038102084831, cost 175.69s 
-- epoch 74 
-- finished epoch in 145.06s 
-- train score: 0.66103180247917, cost 355.67s 
-- test score: 0.41971346410599, cost 175.83s 
-- epoch 75 
-- finished epoch in 145.71s 
-- train score: 0.66476579963422, cost 355.42s 
-- test score: 0.42058642292287, cost 175.70s 
-- epoch 76 
-- finished epoch in 146.93s 
-- train score: 0.66581995529364, cost 355.93s 
-- test score: 0.41966211358735, cost 175.96s 
-- epoch 77 
-- finished epoch in 145.09s 
-- train score: 0.66663279821175, cost 356.02s 
-- test score: 0.41958508780939, cost 175.99s 
-- epoch 78 
-- finished epoch in 145.12s 
-- train score: 0.67029059134322, cost 356.20s 
-- test score: 0.41873780425182, cost 176.01s 
-- epoch 79 
-- finished epoch in 145.05s 
-- train score: 0.67076051615525, cost 355.94s 
-- test score: 0.41943103625347, cost 176.00s 
-- epoch 80 
-- finished epoch in 145.02s 
-- train score: 0.67520575086365, cost 355.93s 
-- test score: 0.41937968573483, cost 175.92s 
-- epoch 81 
-- finished epoch in 145.00s 
-- train score: 0.67467232269864, cost 355.83s 
-- test score: 0.42030399507035, cost 175.90s 
-- epoch 82 
-- finished epoch in 145.92s 
-- train score: 0.67650121926438, cost 356.16s 
-- test score: 0.41976481462463, cost 175.98s 
-- epoch 83 
-- finished epoch in 145.14s 
-- train score: 0.681975208291, cost 355.81s 
-- test score: 0.41994454143987, cost 176.49s 
-- epoch 84 
-- finished epoch in 146.06s 
-- train score: 0.67765698028856, cost 355.95s 
-- test score: 0.42045804662627, cost 176.00s 
-- epoch 85 
-- finished epoch in 145.00s 
-- train score: 0.68167039219671, cost 355.79s 
-- test score: 0.41943103625347, cost 175.93s 
-- epoch 86 
-- finished epoch in 145.09s 
-- train score: 0.68360089412721, cost 355.68s 
-- test score: 0.41889185580774, cost 175.84s 
-- epoch 87 
-- finished epoch in 145.13s 
-- train score: 0.68675066043487, cost 355.74s 
-- test score: 0.41873780425182, cost 175.81s 
-- epoch 88 
-- finished epoch in 145.12s 
-- train score: 0.68780481609429, cost 357.24s 
-- test score: 0.41981616514327, cost 176.66s 
-- epoch 89 
-- finished epoch in 148.85s 
-- train score: 0.68796992481203, cost 364.90s 
-- test score: 0.4218958611482, cost 179.99s 
-- epoch 90 
-- finished epoch in 147.77s 
-- train score: 0.6905481609429, cost 372.31s 
-- test score: 0.42217828900072, cost 184.65s 
-- epoch 91 
-- finished epoch in 152.11s 
-- train score: 0.69195793537899, cost 355.50s 
-- test score: 0.42156208277704, cost 179.09s 
-- epoch 92 
-- finished epoch in 145.89s 
-- train score: 0.69128479983743, cost 357.62s 
-- test score: 0.42071479921947, cost 176.77s 
-- epoch 93 
-- finished epoch in 146.74s 
-- train score: 0.69406624669783, cost 357.70s 
-- test score: 0.41989319092123, cost 176.80s 
-- epoch 94 
-- finished epoch in 146.73s 
-- train score: 0.69913381426539, cost 357.64s 
-- test score: 0.42099722707199, cost 176.77s 
-- epoch 95 
-- finished epoch in 146.58s 
-- train score: 0.69669528551107, cost 357.68s 
-- test score: 0.41989319092123, cost 176.72s 
-- epoch 96 
-- finished epoch in 146.52s 
-- train score: 0.69903220890063, cost 357.33s 
-- test score: 0.42084317551607, cost 176.74s 
-- epoch 97 
-- finished epoch in 146.58s 
-- train score: 0.70013716724243, cost 357.50s 
-- test score: 0.42084317551607, cost 176.67s 
-- epoch 98 
-- finished epoch in 146.62s 
-- train score: 0.70578896565739, cost 357.44s 
-- test score: 0.42056074766355, cost 176.68s 
-- epoch 99 
-- finished epoch in 148.14s 
-- train score: 0.70724954277586, cost 357.73s 
-- test score: 0.41935401047551, cost 180.41s 
-- epoch 100 
-- finished epoch in 144.71s 
-- train score: 0.70540794553952, cost 363.51s 
-- test score: 0.41976481462463, cost 176.23s 
finished training in 69781.79s 
best dev score is: 0.42217828900072 
writing model to ./done/vqalstm-COCOQA-rnnsu.l1.d150.e90.c1-2016-01-09T123031.t7 
