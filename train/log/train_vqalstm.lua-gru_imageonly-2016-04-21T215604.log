[program started on Thu Apr 21 21:56:04 2016] 
[command line arguments] 
rmdeter false 
model gru 
epochs 50 
dataset COCOQA 
cuda true 
caption false 
capopt origin 
modelclass LSTMVQA 
caponly false 
imageonly true 
textonly false 
layers 1 
im_fea_dim 1000 
dim 150 
[----------------------] 
-------------------------------------------------------------------------------- 
LSTM for VQA with text only 
-------------------------------------------------------------------------------- 
loading COCOQA datasets 
loading features 
num train = 78736 
num test  = 38948 
-------------------------------------------------------------------------------- 
model configuration 
-------------------------------------------------------------------------------- 
max epochs                = 50 
num params                = 583330 
num compositional params  = 518400 
LSTM memory dim           = 150 
LSTM structure            = gru 
LSTM layers               = 1 
regularization strength   = 1.00e-04 
minibatch size            = 1 
learning rate             = 5.00e-02 
word vector learning rate = 1.00e-01 
dropout                   = true 
cuda                      = true 
image feature dim         = 1000 
-------------------------------------------------------------------------------- 
Training model 
-------------------------------------------------------------------------------- 
-- epoch 1 
-- finished epoch in 145.00s 
-- train score: 0.25476275147328, cost 370.55s 
-- test score: 0.24912704118312, cost 182.56s 
-- epoch 2 
-- finished epoch in 128.46s 
-- train score: 0.2740677707783, cost 366.16s 
-- test score: 0.26222142343638, cost 182.50s 
-- epoch 3 
-- finished epoch in 123.59s 
-- train score: 0.2840123958545, cost 363.21s 
-- test score: 0.26730512478176, cost 178.70s 
-- epoch 4 
-- finished epoch in 122.42s 
-- train score: 0.29142958748222, cost 362.99s 
-- test score: 0.27670226969292, cost 178.69s 
-- epoch 5 
-- finished epoch in 120.93s 
-- train score: 0.2972845966267, cost 361.19s 
-- test score: 0.27932114614358, cost 178.79s 
-- epoch 6 
-- finished epoch in 120.95s 
-- train score: 0.30546382849014, cost 361.40s 
-- test score: 0.27975762555202, cost 178.58s 
-- epoch 7 
-- finished epoch in 120.91s 
-- train score: 0.30924862832758, cost 361.28s 
-- test score: 0.28476430111944, cost 178.69s 
-- epoch 8 
-- finished epoch in 123.88s 
-- train score: 0.31190306848202, cost 361.74s 
-- test score: 0.28761425490397, cost 181.45s 
-- epoch 9 
-- finished epoch in 125.38s 
-- train score: 0.32037441576915, cost 357.85s 
-- test score: 0.29177364691383, cost 181.10s 
-- epoch 10 
-- finished epoch in 129.17s 
-- train score: 0.32398140621825, cost 360.10s 
-- test score: 0.29149121906131, cost 178.20s 
-- epoch 11 
-- finished epoch in 132.42s 
-- train score: 0.32507366388945, cost 360.08s 
-- test score: 0.29508575536613, cost 184.49s 
-- epoch 12 
-- finished epoch in 124.94s 
-- train score: 0.32790591343223, cost 361.64s 
-- test score: 0.29454657492041, cost 178.45s 
-- epoch 13 
-- finished epoch in 120.86s 
-- train score: 0.33207173338752, cost 361.27s 
-- test score: 0.29739652870494, cost 178.93s 
-- epoch 14 
-- finished epoch in 127.73s 
-- train score: 0.33552631578947, cost 360.81s 
-- test score: 0.29737085344562, cost 178.86s 
-- epoch 15 
-- finished epoch in 128.47s 
-- train score: 0.33646616541353, cost 362.99s 
-- test score: 0.3009140392318, cost 319.35s 
-- epoch 16 
-- finished epoch in 368.15s 
-- train score: 0.33923491160333, cost 690.95s 
-- test score: 0.29878299270823, cost 328.88s 
-- epoch 17 
-- finished epoch in 160.15s 
-- train score: 0.34232117455802, cost 820.32s 
-- test score: 0.30163294649276, cost 329.84s 
-- epoch 18 
-- finished epoch in 159.31s 
-- train score: 0.34379445234708, cost 697.28s 
-- test score: 0.30217212693848, cost 413.91s 
-- epoch 19 
-- finished epoch in 244.80s 
-- train score: 0.34497561471246, cost 669.04s 
-- test score: 0.30337886412653, cost 334.36s 
-- epoch 20 
-- finished epoch in 389.97s 
-- train score: 0.34925574070311, cost 736.10s 
-- test score: 0.30435452398069, cost 330.39s 
-- epoch 21 
-- finished epoch in 158.93s 
-- train score: 0.3498272708799, cost 782.95s 
-- test score: 0.30491937968573, cost 355.16s 
-- epoch 22 
-- finished epoch in 159.46s 
-- train score: 0.35330725462304, cost 669.56s 
-- test score: 0.30335318886721, cost 404.02s 
-- epoch 23 
-- finished epoch in 381.68s 
-- train score: 0.35395498882341, cost 666.25s 
-- test score: 0.30566396220602, cost 332.11s 
-- epoch 24 
-- finished epoch in 278.48s 
-- train score: 0.35695234708393, cost 779.04s 
-- test score: 0.30466262709253, cost 332.79s 
-- epoch 25 
-- finished epoch in 160.07s 
-- train score: 0.35772708799025, cost 788.90s 
-- test score: 0.30699907569066, cost 376.91s 
-- epoch 26 
-- finished epoch in 159.41s 
-- train score: 0.35940357650884, cost 664.94s 
-- test score: 0.30651124576358, cost 439.12s 
-- epoch 27 
-- finished epoch in 390.02s 
-- train score: 0.36162619386304, cost 671.51s 
-- test score: 0.30733285406183, cost 330.53s 
-- epoch 28 
-- finished epoch in 244.68s 
-- train score: 0.36312487299329, cost 870.66s 
-- test score: 0.30417479716545, cost 330.99s 
-- epoch 29 
-- finished epoch in 159.56s 
-- train score: 0.3636710018289, cost 787.89s 
-- test score: 0.30435452398069, cost 364.96s 
-- epoch 30 
-- finished epoch in 158.14s 
-- train score: 0.36396311725259, cost 671.63s 
-- test score: 0.30630584368902, cost 412.60s 
-- epoch 31 
-- finished epoch in 386.89s 
-- train score: 0.3664397480187, cost 669.23s 
-- test score: 0.30738420458047, cost 330.04s 
-- epoch 32 
-- finished epoch in 288.03s 
-- train score: 0.36815433854908, cost 776.95s 
-- test score: 0.30792338502619, cost 330.61s 
-- epoch 33 
-- finished epoch in 159.59s 
-- train score: 0.36990703109124, cost 760.47s 
-- test score: 0.30625449317038, cost 386.09s 
-- epoch 34 
-- finished epoch in 158.41s 
-- train score: 0.37092308473887, cost 668.86s 
-- test score: 0.30758960665503, cost 380.32s 
-- epoch 35 
-- finished epoch in 398.34s 
-- train score: 0.37337431416379, cost 700.72s 
-- test score: 0.30764095717367, cost 336.46s 
-- epoch 36 
-- finished epoch in 251.99s 
-- train score: 0.37287898801057, cost 943.26s 
-- test score: 0.30684502413474, cost 336.50s 
-- epoch 37 
-- finished epoch in 158.06s 
-- train score: 0.37596525096525, cost 908.04s 
-- test score: 0.30769230769231, cost 332.75s 
-- epoch 38 
-- finished epoch in 159.30s 
-- train score: 0.37460627921154, cost 738.37s 
-- test score: 0.30859094176851, cost 415.19s 
-- epoch 39 
-- finished epoch in 157.70s 
-- train score: 0.37593984962406, cost 671.67s 
-- test score: 0.30751258087707, cost 355.83s 
-- epoch 40 
-- finished epoch in 392.76s 
-- train score: 0.37830217435481, cost 721.76s 
-- test score: 0.30887336962103, cost 333.34s 
-- epoch 41 
-- finished epoch in 158.34s 
-- train score: 0.37850538508433, cost 836.64s 
-- test score: 0.30866796754647, cost 336.45s 
-- epoch 42 
-- finished epoch in 160.02s 
-- train score: 0.37944523470839, cost 819.20s 
-- test score: 0.30884769436171, cost 409.65s 
-- epoch 43 
-- finished epoch in 158.90s 
-- train score: 0.38166785206259, cost 672.30s 
-- test score: 0.30861661702783, cost 365.82s 
-- epoch 44 
-- finished epoch in 392.45s 
-- train score: 0.38171865474497, cost 714.89s 
-- test score: 0.30920714799219, cost 331.24s 
-- epoch 45 
-- finished epoch in 158.21s 
-- train score: 0.38361105466369, cost 816.45s 
-- test score: 0.30800041080415, cost 331.75s 
-- epoch 46 
-- finished epoch in 158.29s 
-- train score: 0.38500812842918, cost 699.08s 
-- test score: 0.30815446236007, cost 417.12s 
-- epoch 47 
-- finished epoch in 256.39s 
-- train score: 0.38574476732371, cost 668.63s 
-- test score: 0.30792338502619, cost 332.42s 
-- epoch 48 
-- finished epoch in 393.10s 
-- train score: 0.38698943304206, cost 741.54s 
-- test score: 0.31002875629044, cost 331.96s 
-- epoch 49 
-- finished epoch in 158.44s 
-- train score: 0.38761176590124, cost 824.46s 
-- test score: 0.30943822532608, cost 343.77s 
-- epoch 50 
-- finished epoch in 159.58s 
-- train score: 0.38698943304206, cost 676.12s 
-- test score: 0.30800041080415, cost 424.31s 
finished training in 56979.83s 
best dev score is: 0.31002875629044 
writing model to ./done/vqalstm-COCOQA-gru_imageonly.l1.d150.e48.c1-2016-04-22T134550.t7 
