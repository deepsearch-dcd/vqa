[program started on Mon Jan 18 18:33:45 2016] 
[command line arguments] 
[----------------------] 
-------------------------------------------------------------------------------- 
LSTM for VQA 
-------------------------------------------------------------------------------- 
loading COCOQA datasets 
Remove determiner done. 
loading features 
num train = 78736 
num test  = 38948 
-------------------------------------------------------------------------------- 
model configuration 
-------------------------------------------------------------------------------- 
max epochs                = 100 
num params                = 1947410 
num compositional params  = 121200 
word vector dim           = 50 
LSTM memory dim           = 150 
LSTM structure            = lstm 
LSTM layers               = 1 
regularization strength   = 1.00e-04 
minibatch size            = 1 
learning rate             = 5.00e-02 
word vector learning rate = 1.00e-01 
dropout                   = true 
cuda                      = true 
image feature dim         = 4096 
-------------------------------------------------------------------------------- 
Training model 
-------------------------------------------------------------------------------- 
-- epoch 1 
-- finished epoch in 589.37s 
-- train score: 0.401557102215, cost 512.90s 
-- test score: 0.33724453116976, cost 248.05s 
-- epoch 2 
-- finished epoch in 572.93s 
-- train score: 0.47020422678317, cost 510.08s 
-- test score: 0.37488446133306, cost 252.18s 
-- epoch 3 
-- finished epoch in 571.60s 
-- train score: 0.4939036781142, cost 504.23s 
-- test score: 0.39188148300298, cost 249.33s 
-- epoch 4 
-- finished epoch in 567.64s 
-- train score: 0.53890215403373, cost 504.05s 
-- test score: 0.42199856218548, cost 249.18s 
-- epoch 5 
-- finished epoch in 569.20s 
-- train score: 0.54033732981101, cost 505.02s 
-- test score: 0.41362842764712, cost 248.12s 
-- epoch 6 
-- finished epoch in 570.56s 
-- train score: 0.56686903068482, cost 502.81s 
-- test score: 0.43552942384718, cost 248.09s 
-- epoch 7 
-- finished epoch in 573.42s 
-- train score: 0.58020473481, cost 503.49s 
-- test score: 0.43807127451987, cost 248.87s 
-- epoch 8 
-- finished epoch in 570.28s 
-- train score: 0.58787593984962, cost 506.81s 
-- test score: 0.44184553763993, cost 249.25s 
-- epoch 9 
-- finished epoch in 569.26s 
-- train score: 0.60570768136558, cost 504.23s 
-- test score: 0.45396426003903, cost 249.21s 
-- epoch 10 
-- finished epoch in 568.82s 
-- train score: 0.61215962202804, cost 504.85s 
-- test score: 0.45288589914758, cost 249.51s 
-- epoch 11 
-- finished epoch in 575.11s 
-- train score: 0.62052936395042, cost 510.71s 
-- test score: 0.46022902331314, cost 253.54s 
-- epoch 12 
-- finished epoch in 570.12s 
-- train score: 0.62378073562284, cost 511.39s 
-- test score: 0.4558385539694, cost 252.15s 
-- epoch 13 
-- finished epoch in 570.95s 
-- train score: 0.63378886405202, cost 513.35s 
-- test score: 0.4661856834754, cost 252.81s 
-- epoch 14 
-- finished epoch in 572.48s 
-- train score: 0.63961847185531, cost 511.64s 
-- test score: 0.46202629146554, cost 252.83s 
-- epoch 15 
-- finished epoch in 572.25s 
-- train score: 0.64634982727088, cost 511.83s 
-- test score: 0.46669918866181, cost 252.95s 
-- epoch 16 
-- finished epoch in 569.51s 
-- train score: 0.64734047957732, cost 510.83s 
-- test score: 0.4688559104447, cost 252.55s 
-- epoch 17 
-- finished epoch in 571.11s 
-- train score: 0.65492277992278, cost 511.35s 
-- test score: 0.47411933860532, cost 252.73s 
-- epoch 18 
-- finished epoch in 569.62s 
-- train score: 0.65941881731355, cost 510.67s 
-- test score: 0.47263017356475, cost 252.48s 
-- epoch 19 
-- finished epoch in 570.43s 
-- train score: 0.66350843324528, cost 510.65s 
-- test score: 0.47514634897812, cost 252.39s 
-- epoch 20 
-- finished epoch in 571.00s 
-- train score: 0.66837279008332, cost 511.08s 
-- test score: 0.47560850364589, cost 252.67s 
-- epoch 21 
-- finished epoch in 570.84s 
-- train score: 0.67018898597846, cost 511.59s 
-- test score: 0.47196261682243, cost 252.85s 
-- epoch 22 
-- finished epoch in 569.71s 
-- train score: 0.68264834383255, cost 509.52s 
-- test score: 0.47789360172538, cost 251.85s 
-- epoch 23 
-- finished epoch in 570.40s 
-- train score: 0.68153068482016, cost 510.08s 
-- test score: 0.47781657594742, cost 252.12s 
-- epoch 24 
-- finished epoch in 570.14s 
-- train score: 0.68534088599878, cost 509.96s 
-- test score: 0.48051247817603, cost 259.61s 
-- epoch 25 
-- finished epoch in 635.65s 
-- train score: 0.69089107904897, cost 540.84s 
-- test score: 0.4820016432166, cost 267.37s 
-- epoch 26 
-- finished epoch in 569.59s 
-- train score: 0.69566653119285, cost 514.07s 
-- test score: 0.48346513299784, cost 252.07s 
-- epoch 27 
-- finished epoch in 570.50s 
-- train score: 0.69350741719163, cost 509.47s 
-- test score: 0.47910033891342, cost 251.92s 
-- epoch 28 
-- finished epoch in 570.54s 
-- train score: 0.69750812842918, cost 509.53s 
-- test score: 0.48058950395399, cost 251.84s 
-- epoch 29 
-- finished epoch in 569.79s 
-- train score: 0.70068329607803, cost 510.52s 
-- test score: 0.48320838040464, cost 252.32s 
-- epoch 30 
-- finished epoch in 569.73s 
-- train score: 0.70566195895143, cost 509.57s 
-- test score: 0.48333675670124, cost 251.85s 
-- epoch 31 
-- finished epoch in 569.76s 
-- train score: 0.70820209307051, cost 510.29s 
-- test score: 0.48695696826538, cost 252.28s 
-- epoch 32 
-- finished epoch in 570.49s 
-- train score: 0.71808321479374, cost 510.63s 
-- test score: 0.49155283968368, cost 252.40s 
-- epoch 33 
-- finished epoch in 570.31s 
-- train score: 0.71738467791099, cost 509.88s 
-- test score: 0.48924206634487, cost 252.00s 
-- epoch 34 
-- finished epoch in 569.73s 
-- train score: 0.71894686039423, cost 510.44s 
-- test score: 0.49381226250385, cost 252.30s 
-- epoch 35 
-- finished epoch in 569.88s 
-- train score: 0.7206741515952, cost 511.20s 
-- test score: 0.4867258909315, cost 252.75s 
-- epoch 36 
-- finished epoch in 570.54s 
-- train score: 0.7281421459053, cost 511.14s 
-- test score: 0.49324740679881, cost 252.62s 
-- epoch 37 
-- finished epoch in 571.03s 
-- train score: 0.72736740499898, cost 510.40s 
-- test score: 0.49124473657184, cost 252.33s 
-- epoch 38 
-- finished epoch in 570.62s 
-- train score: 0.73370503962609, cost 511.02s 
-- test score: 0.48939611790079, cost 252.63s 
-- epoch 39 
-- finished epoch in 570.58s 
-- train score: 0.73322241414347, cost 510.98s 
-- test score: 0.48939611790079, cost 252.56s 
-- epoch 40 
-- finished epoch in 570.88s 
-- train score: 0.73084738874213, cost 511.14s 
-- test score: 0.49011502516175, cost 252.62s 
-- epoch 41 
-- finished epoch in 570.65s 
-- train score: 0.7342257671205, cost 511.49s 
-- test score: 0.48531375166889, cost 252.82s 
-- epoch 42 
-- finished epoch in 570.36s 
-- train score: 0.73633407843934, cost 511.17s 
-- test score: 0.49173256649892, cost 252.66s 
-- epoch 43 
-- finished epoch in 570.96s 
-- train score: 0.73685480593375, cost 511.23s 
-- test score: 0.48652048885694, cost 252.71s 
-- epoch 44 
-- finished epoch in 570.63s 
-- train score: 0.74009347693558, cost 511.07s 
-- test score: 0.49198931909212, cost 252.63s 
-- epoch 45 
-- finished epoch in 570.43s 
-- train score: 0.74389097744361, cost 511.16s 
-- test score: 0.49263120057513, cost 252.62s 
-- epoch 46 
-- finished epoch in 570.82s 
-- train score: 0.74156675472465, cost 510.76s 
-- test score: 0.49589195850878, cost 252.49s 
-- epoch 47 
-- finished epoch in 568.68s 
-- train score: 0.74211288356025, cost 510.43s 
-- test score: 0.48931909212283, cost 252.40s 
-- epoch 48 
-- finished epoch in 570.33s 
-- train score: 0.74537695590327, cost 509.75s 
-- test score: 0.48847180856527, cost 252.01s 
-- epoch 49 
-- finished epoch in 570.36s 
-- train score: 0.74753606990449, cost 509.44s 
-- test score: 0.49455684502413, cost 251.85s 
-- epoch 50 
-- finished epoch in 569.19s 
-- train score: 0.74961897988214, cost 509.56s 
-- test score: 0.49350415939201, cost 251.81s 
-- epoch 51 
-- finished epoch in 569.71s 
-- train score: 0.75688376346271, cost 510.62s 
-- test score: 0.49460819554277, cost 252.38s 
-- epoch 52 
-- finished epoch in 569.61s 
-- train score: 0.75753149766308, cost 509.45s 
-- test score: 0.49946081955428, cost 251.76s 
-- epoch 53 
-- finished epoch in 570.07s 
-- train score: 0.75582960780329, cost 510.78s 
-- test score: 0.49155283968368, cost 252.43s 
-- epoch 54 
-- finished epoch in 570.63s 
-- train score: 0.76559642349116, cost 510.52s 
-- test score: 0.49712437095615, cost 252.41s 
-- epoch 55 
-- finished epoch in 570.74s 
-- train score: 0.75905557813453, cost 510.51s 
-- test score: 0.49368388620725, cost 252.33s 
-- epoch 56 
-- finished epoch in 571.10s 
-- train score: 0.76334840479577, cost 510.70s 
-- test score: 0.49435144294957, cost 252.40s 
-- epoch 57 
-- finished epoch in 570.63s 
-- train score: 0.76695539524487, cost 510.63s 
-- test score: 0.49519872650714, cost 252.33s 
-- epoch 58 
-- finished epoch in 570.87s 
-- train score: 0.77241668360089, cost 510.48s 
-- test score: 0.49730409777139, cost 252.32s 
-- epoch 59 
-- finished epoch in 570.65s 
-- train score: 0.76784444218655, cost 510.82s 
-- test score: 0.49432576769025, cost 252.52s 
-- epoch 60 
-- finished epoch in 570.64s 
-- train score: 0.77023216825848, cost 510.53s 
-- test score: 0.50043647940844, cost 252.37s 
-- epoch 61 
-- finished epoch in 569.52s 
-- train score: 0.78190408453566, cost 510.28s 
-- test score: 0.49887028858991, cost 252.24s 
-- epoch 62 
-- finished epoch in 570.36s 
-- train score: 0.77159114001219, cost 509.67s 
-- test score: 0.49373523672589, cost 251.88s 
-- epoch 63 
-- finished epoch in 570.43s 
-- train score: 0.77733184312132, cost 509.89s 
-- test score: 0.50079593303892, cost 251.97s 
-- epoch 64 
-- finished epoch in 569.97s 
-- train score: 0.76637116439748, cost 510.05s 
-- test score: 0.48577590633665, cost 252.07s 
-- epoch 65 
-- finished epoch in 570.74s 
-- train score: 0.77674761227393, cost 510.27s 
-- test score: 0.49807435555099, cost 250.87s 
-- epoch 66 
-- finished epoch in 570.54s 
-- train score: 0.77728104043894, cost 504.53s 
-- test score: 0.49345280887337, cost 249.40s 
-- epoch 67 
-- finished epoch in 571.47s 
-- train score: 0.78441881731355, cost 505.72s 
-- test score: 0.49486494813598, cost 248.25s 
-- epoch 68 
-- finished epoch in 570.36s 
-- train score: 0.78389808981914, cost 502.71s 
-- test score: 0.49504467495122, cost 248.40s 
-- epoch 69 
-- finished epoch in 570.55s 
-- train score: 0.78434261328998, cost 502.57s 
-- test score: 0.49732977303071, cost 248.39s 
-- epoch 70 
-- finished epoch in 571.40s 
-- train score: 0.79132798211746, cost 503.64s 
-- test score: 0.49715004621547, cost 249.02s 
-- epoch 71 
-- finished epoch in 573.84s 
-- train score: 0.78053241211136, cost 502.35s 
-- test score: 0.49180959227688, cost 248.31s 
-- epoch 72 
-- finished epoch in 570.68s 
-- train score: 0.79012141841089, cost 502.64s 
-- test score: 0.5010270103728, cost 248.42s 
-- epoch 73 
-- finished epoch in 571.24s 
-- train score: 0.78655252997358, cost 504.80s 
-- test score: 0.50097565985416, cost 249.59s 
-- epoch 74 
-- finished epoch in 570.84s 
-- train score: 0.79228053241211, cost 504.92s 
-- test score: 0.50238779911677, cost 249.61s 
-- epoch 75 
-- finished epoch in 571.80s 
-- train score: 0.79555730542573, cost 506.36s 
-- test score: 0.49956352059156, cost 250.90s 
-- epoch 76 
-- finished epoch in 573.17s 
-- train score: 0.79343629343629, cost 503.00s 
-- test score: 0.50261887645065, cost 248.80s 
-- epoch 77 
-- finished epoch in 567.97s 
-- train score: 0.79400782361309, cost 500.98s 
-- test score: 0.49722707199343, cost 248.17s 
-- epoch 78 
-- finished epoch in 568.89s 
-- train score: 0.79852926234505, cost 503.12s 
-- test score: 0.50218239704221, cost 248.26s 
-- epoch 79 
-- finished epoch in 569.99s 
-- train score: 0.7972972972973, cost 503.40s 
-- test score: 0.50125808770669, cost 249.06s 
-- epoch 80 
-- finished epoch in 570.78s 
-- train score: 0.80131070920545, cost 502.56s 
-- test score: 0.499358118517, cost 248.51s 
-- epoch 81 
-- finished epoch in 571.83s 
-- train score: 0.79987553342816, cost 504.25s 
-- test score: 0.49717572147479, cost 249.19s 
-- epoch 82 
-- finished epoch in 570.41s 
-- train score: 0.80540032513717, cost 505.59s 
-- test score: 0.50092430933552, cost 249.97s 
-- epoch 83 
-- finished epoch in 571.76s 
-- train score: 0.80677199756147, cost 505.10s 
-- test score: 0.49820273184759, cost 249.63s 
-- epoch 84 
-- finished epoch in 572.05s 
-- train score: 0.79130258077627, cost 505.22s 
-- test score: 0.48677724145014, cost 249.77s 
-- epoch 85 
-- finished epoch in 570.56s 
-- train score: 0.80684820158504, cost 505.99s 
-- test score: 0.50302968059977, cost 251.91s 
-- epoch 86 
-- finished epoch in 568.33s 
-- train score: 0.81130613696403, cost 504.69s 
-- test score: 0.50159186607785, cost 249.20s 
-- epoch 87 
-- finished epoch in 570.05s 
-- train score: 0.81487502540134, cost 503.88s 
-- test score: 0.49928109273904, cost 249.19s 
-- epoch 88 
-- finished epoch in 573.45s 
-- train score: 0.81049329404593, cost 503.21s 
-- test score: 0.49442846872753, cost 248.73s 
-- epoch 89 
-- finished epoch in 576.52s 
-- train score: 0.80705141231457, cost 505.15s 
-- test score: 0.50390263941666, cost 248.95s 
-- epoch 90 
-- finished epoch in 568.67s 
-- train score: 0.81430349522455, cost 502.09s 
-- test score: 0.49953784533224, cost 248.13s 
-- epoch 91 
-- finished epoch in 569.75s 
-- train score: 0.81417648851859, cost 502.68s 
-- test score: 0.50035945363048, cost 248.52s 
-- epoch 92 
-- finished epoch in 567.43s 
-- train score: 0.81516714082504, cost 502.28s 
-- test score: 0.50182294341173, cost 248.32s 
-- epoch 93 
-- finished epoch in 567.01s 
-- train score: 0.81841851249746, cost 502.34s 
-- test score: 0.50189996918969, cost 248.50s 
-- epoch 94 
-- finished epoch in 570.65s 
-- train score: 0.81229678927047, cost 501.77s 
-- test score: 0.49964054636952, cost 248.52s 
-- epoch 95 
-- finished epoch in 567.87s 
-- train score: 0.81257620402357, cost 501.75s 
-- test score: 0.49679059258499, cost 247.92s 
-- epoch 96 
-- finished epoch in 567.95s 
-- train score: 0.81899004267425, cost 501.74s 
-- test score: 0.50336345897094, cost 247.97s 
-- epoch 97 
-- finished epoch in 567.78s 
-- train score: 0.81778347896769, cost 504.10s 
-- test score: 0.50315805689637, cost 247.92s 
-- epoch 98 
-- finished epoch in 574.22s 
-- train score: 0.81958697419224, cost 501.53s 
-- test score: 0.49925541747972, cost 247.79s 
-- epoch 99 
-- finished epoch in 567.59s 
-- train score: 0.82456563706564, cost 501.53s 
-- test score: 0.49658519051042, cost 248.04s 
-- epoch 100 
-- finished epoch in 569.31s 
-- train score: 0.82423541963016, cost 501.76s 
-- test score: 0.50454452089966, cost 248.97s 
finished training in 133033.57s 
best dev score is: 0.50454452089966 
writing model to ./done/vqalstm-COCOQA-lstm.l1.d150.e100.c1-2016-01-20T073107.t7 
