[program started on Sun Apr  3 05:52:59 2016] 
[command line arguments] 
rmdeter true 
caponly true 
dataset COCOQA 
cuda true 
caption true 
epochs 50 
modelclass LSTMVQA 
capopt generate 
model gru 
textonly true 
layers 1 
im_fea_dim 1024 
dim 150 
[----------------------] 
-------------------------------------------------------------------------------- 
LSTM for VQA with text only 
-------------------------------------------------------------------------------- 
loading COCOQA datasets 
Append captions with question done. 
Remove determiner done. 
num train = 78736 
num test  = 38948 
-------------------------------------------------------------------------------- 
model configuration 
-------------------------------------------------------------------------------- 
max epochs                = 50 
num params                = 155830 
num compositional params  = 90900 
word vector dim           = 50 
LSTM memory dim           = 150 
LSTM structure            = gru 
LSTM layers               = 1 
regularization strength   = 1.00e-04 
minibatch size            = 1 
learning rate             = 5.00e-02 
word vector learning rate = 1.00e-01 
dropout                   = true 
cuda                      = true 
image feature dim         = [text only] 
-------------------------------------------------------------------------------- 
Training model 
-------------------------------------------------------------------------------- 
-- epoch 1 
-- finished epoch in 421.05s 
-- train score: 0.39904236943711, cost 462.84s 
-- test score: 0.39619492656876, cost 228.69s 
-- epoch 2 
-- finished epoch in 416.06s 
-- train score: 0.40977443609023, cost 462.62s 
-- test score: 0.40489883947828, cost 228.69s 
-- epoch 3 
-- finished epoch in 419.04s 
-- train score: 0.41429587482219, cost 458.33s 
-- test score: 0.41023929341686, cost 228.07s 
-- epoch 4 
-- finished epoch in 413.18s 
-- train score: 0.4153881324934, cost 461.46s 
-- test score: 0.40916093252542, cost 227.96s 
-- epoch 5 
-- finished epoch in 413.00s 
-- train score: 0.41834738874213, cost 461.31s 
-- test score: 0.41239601519975, cost 227.97s 
-- epoch 6 
-- finished epoch in 412.49s 
-- train score: 0.41990957122536, cost 461.35s 
-- test score: 0.41134332956763, cost 227.96s 
-- epoch 7 
-- finished epoch in 411.80s 
-- train score: 0.41860140215403, cost 461.27s 
-- test score: 0.40985416452706, cost 227.92s 
-- epoch 8 
-- finished epoch in 411.84s 
-- train score: 0.42214488925015, cost 460.78s 
-- test score: 0.41190818527267, cost 227.76s 
-- epoch 9 
-- finished epoch in 411.89s 
-- train score: 0.42319904490957, cost 460.66s 
-- test score: 0.41352572660984, cost 227.73s 
-- epoch 10 
-- finished epoch in 444.22s 
-- train score: 0.4239356838041, cost 459.90s 
-- test score: 0.41380815446236, cost 226.96s 
-- epoch 11 
-- finished epoch in 418.32s 
-- train score: 0.42387218045113, cost 459.06s 
-- test score: 0.41211358734723, cost 227.30s 
-- epoch 12 
-- finished epoch in 421.30s 
-- train score: 0.42411349319244, cost 461.71s 
-- test score: 0.41288384512684, cost 226.76s 
-- epoch 13 
-- finished epoch in 418.11s 
-- train score: 0.42567567567568, cost 460.86s 
-- test score: 0.41249871623703, cost 227.69s 
-- epoch 14 
-- finished epoch in 412.16s 
-- train score: 0.42629800853485, cost 460.42s 
-- test score: 0.41326897401664, cost 227.62s 
-- epoch 15 
-- finished epoch in 412.07s 
-- train score: 0.42664092664093, cost 462.98s 
-- test score: 0.41370545342508, cost 228.72s 
-- epoch 16 
-- finished epoch in 412.23s 
-- train score: 0.42731406218248, cost 463.96s 
-- test score: 0.41211358734723, cost 229.28s 
-- epoch 17 
-- finished epoch in 412.28s 
-- train score: 0.42714895346474, cost 462.76s 
-- test score: 0.41255006675567, cost 228.69s 
-- epoch 18 
-- finished epoch in 429.05s 
-- train score: 0.4289397480187, cost 465.19s 
-- test score: 0.41247304097771, cost 229.83s 
-- epoch 19 
-- finished epoch in 415.31s 
-- train score: 0.42858412924202, cost 462.15s 
-- test score: 0.41237033994043, cost 228.37s 
-- epoch 20 
-- finished epoch in 415.38s 
-- train score: 0.42854602723024, cost 463.09s 
-- test score: 0.41180548423539, cost 228.77s 
-- epoch 21 
-- finished epoch in 433.22s 
-- train score: 0.42989229831335, cost 501.07s 
-- test score: 0.41314059772004, cost 247.64s 
-- epoch 22 
-- finished epoch in 488.68s 
-- train score: 0.430311420443, cost 501.54s 
-- test score: 0.41134332956763, cost 247.82s 
-- epoch 23 
-- finished epoch in 488.76s 
-- train score: 0.42994310099573, cost 500.06s 
-- test score: 0.41149738112355, cost 247.06s 
-- epoch 24 
-- finished epoch in 478.49s 
-- train score: 0.4311369640317, cost 459.12s 
-- test score: 0.41131765430831, cost 227.72s 
-- epoch 25 
-- finished epoch in 416.15s 
-- train score: 0.43130207274944, cost 459.13s 
-- test score: 0.41370545342508, cost 226.85s 
-- epoch 26 
-- finished epoch in 418.57s 
-- train score: 0.43184820158504, cost 460.05s 
-- test score: 0.41172845845743, cost 227.35s 
-- epoch 27 
-- finished epoch in 418.49s 
-- train score: 0.43175929689088, cost 460.36s 
-- test score: 0.41185683475403, cost 228.39s 
-- epoch 28 
-- finished epoch in 412.31s 
-- train score: 0.4328007518797, cost 460.15s 
-- test score: 0.41170278319811, cost 227.37s 
-- epoch 29 
-- finished epoch in 416.61s 
-- train score: 0.43357549278602, cost 460.64s 
-- test score: 0.41154873164219, cost 227.66s 
-- epoch 30 
-- finished epoch in 411.46s 
-- train score: 0.43342308473887, cost 460.62s 
-- test score: 0.41113792749307, cost 227.60s 
-- epoch 31 
-- finished epoch in 411.50s 
-- train score: 0.43450264173948, cost 462.28s 
-- test score: 0.41221628838451, cost 228.41s 
-- epoch 32 
-- finished epoch in 411.41s 
-- train score: 0.43386760820971, cost 460.72s 
-- test score: 0.41177980897607, cost 227.69s 
-- epoch 33 
-- finished epoch in 416.16s 
-- train score: 0.43475665515139, cost 455.72s 
-- test score: 0.41116360275239, cost 225.30s 
-- epoch 34 
-- finished epoch in 416.54s 
-- train score: 0.43542979069295, cost 459.27s 
-- test score: 0.41147170586423, cost 226.28s 
-- epoch 35 
-- finished epoch in 416.00s 
-- train score: 0.43645854501118, cost 456.15s 
-- test score: 0.40908390674746, cost 225.38s 
-- epoch 36 
-- finished epoch in 416.23s 
-- train score: 0.43582351148141, cost 458.15s 
-- test score: 0.41131765430831, cost 226.31s 
-- epoch 37 
-- finished epoch in 416.07s 
-- train score: 0.4361283275757, cost 456.16s 
-- test score: 0.41021361815754, cost 226.44s 
-- epoch 38 
-- finished epoch in 417.28s 
-- train score: 0.43689036781142, cost 457.09s 
-- test score: 0.41090685015919, cost 226.36s 
-- epoch 39 
-- finished epoch in 416.99s 
-- train score: 0.43762700670595, cost 457.34s 
-- test score: 0.41049604601006, cost 225.64s 
-- epoch 40 
-- finished epoch in 417.25s 
-- train score: 0.43747459865881, cost 458.97s 
-- test score: 0.41075279860327, cost 226.26s 
-- epoch 41 
-- finished epoch in 421.52s 
-- train score: 0.43719518390571, cost 459.31s 
-- test score: 0.41036766971346, cost 226.65s 
-- epoch 42 
-- finished epoch in 420.56s 
-- train score: 0.43774131274131, cost 458.99s 
-- test score: 0.40890417993222, cost 226.72s 
-- epoch 43 
-- finished epoch in 421.98s 
-- train score: 0.43822393822394, cost 460.09s 
-- test score: 0.40934065934066, cost 227.11s 
-- epoch 44 
-- finished epoch in 411.27s 
-- train score: 0.43864306035359, cost 459.77s 
-- test score: 0.40928930882202, cost 227.34s 
-- epoch 45 
-- finished epoch in 411.48s 
-- train score: 0.43890977443609, cost 459.87s 
-- test score: 0.40872445311698, cost 227.17s 
-- epoch 46 
-- finished epoch in 411.38s 
-- train score: 0.43922729120098, cost 459.48s 
-- test score: 0.41059874704735, cost 227.04s 
-- epoch 47 
-- finished epoch in 411.46s 
-- train score: 0.43948130461288, cost 459.31s 
-- test score: 0.41057307178803, cost 226.94s 
-- epoch 48 
-- finished epoch in 411.39s 
-- train score: 0.44006553546027, cost 459.91s 
-- test score: 0.40882715415426, cost 227.30s 
-- epoch 49 
-- finished epoch in 411.65s 
-- train score: 0.44014173948384, cost 460.31s 
-- test score: 0.41008524186094, cost 227.43s 
-- epoch 50 
-- finished epoch in 411.40s 
-- train score: 0.44066246697826, cost 459.91s 
-- test score: 0.40916093252542, cost 227.28s 
finished training in 55590.81s 
best dev score is: 0.41380815446236 
writing model to ./done/vqalstm-COCOQA-gru_textonly.l1.d150.e10.c1-2016-04-03T211935.t7 
