[program started on Fri Jan 22 10:31:10 2016] 
[command line arguments] 
[----------------------] 
-------------------------------------------------------------------------------- 
LSTM for VQA 
-------------------------------------------------------------------------------- 
loading COCOQA datasets 
Remove determiner done. 
loading features 
num train = 78736 
num test  = 38948 
-------------------------------------------------------------------------------- 
model configuration 
-------------------------------------------------------------------------------- 
max epochs                = 100 
num params                = 786130 
num compositional params  = 721200 
word vector dim           = 50 
LSTM memory dim           = 150 
LSTM structure            = lstm 
LSTM layers               = 1 
regularization strength   = 1.00e-04 
minibatch size            = 1 
learning rate             = 5.00e-02 
word vector learning rate = 1.00e-01 
dropout                   = true 
cuda                      = true 
image feature dim         = 1000 
-------------------------------------------------------------------------------- 
Training model 
-------------------------------------------------------------------------------- 
-- epoch 1 
-- finished epoch in 1511.13s 
-- train score: 0.24436090225564, cost 969.61s 
-- test score: 0.2374961487111, cost 481.11s 
-- epoch 2 
-- finished epoch in 1490.81s 
-- train score: 0.26196403170087, cost 973.56s 
-- test score: 0.25277292800657, cost 481.58s 
-- epoch 3 
-- finished epoch in 1489.49s 
-- train score: 0.27646819752083, cost 971.84s 
-- test score: 0.26319708329054, cost 480.13s 
-- epoch 4 
-- finished epoch in 1498.86s 
-- train score: 0.2829201381833, cost 977.97s 
-- test score: 0.26856321248845, cost 483.57s 
-- epoch 5 
-- finished epoch in 1489.87s 
-- train score: 0.28990550701077, cost 971.17s 
-- test score: 0.27582931087604, cost 480.10s 
-- epoch 6 
-- finished epoch in 1490.83s 
-- train score: 0.293131477342, cost 972.62s 
-- test score: 0.27503337783712, cost 482.19s 
-- epoch 7 
-- finished epoch in 1489.45s 
-- train score: 0.30105669579354, cost 972.69s 
-- test score: 0.28116976481462, cost 479.46s 
-- epoch 8 
-- finished epoch in 1490.42s 
-- train score: 0.3064290794554, cost 971.56s 
-- test score: 0.28299270822635, cost 482.08s 
-- epoch 9 
-- finished epoch in 1494.16s 
-- train score: 0.31069650477545, cost 973.53s 
-- test score: 0.28530348156516, cost 480.28s 
-- epoch 10 
-- finished epoch in 1491.33s 
-- train score: 0.33287187563503, cost 969.44s 
-- test score: 0.30414912190613, cost 481.11s 
-- epoch 11 
-- finished epoch in 1489.94s 
-- train score: 0.37865779313148, cost 975.33s 
-- test score: 0.34646194926569, cost 480.45s 
-- epoch 12 
-- finished epoch in 1488.35s 
-- train score: 0.38552885592359, cost 971.10s 
-- test score: 0.35339426928212, cost 512.63s 
-- epoch 13 
-- finished epoch in 1488.51s 
-- train score: 0.38972007722008, cost 973.60s 
-- test score: 0.35516586217521, cost 479.50s 
-- epoch 14 
-- finished epoch in 1493.90s 
-- train score: 0.39720077220077, cost 970.41s 
-- test score: 0.35968470781555, cost 481.97s 
-- epoch 15 
-- finished epoch in 1489.62s 
-- train score: 0.41501981304613, cost 974.72s 
-- test score: 0.37457635822122, cost 479.02s 
-- epoch 16 
-- finished epoch in 1490.15s 
-- train score: 0.4297652916074, cost 970.80s 
-- test score: 0.38559104446955, cost 482.55s 
-- epoch 17 
-- finished epoch in 1487.76s 
-- train score: 0.43545519203414, cost 974.02s 
-- test score: 0.38854369929136, cost 479.67s 
-- epoch 18 
-- finished epoch in 1496.39s 
-- train score: 0.43680146311725, cost 973.40s 
-- test score: 0.3915220293725, cost 482.79s 
-- epoch 19 
-- finished epoch in 1487.92s 
-- train score: 0.44223735013209, cost 973.13s 
-- test score: 0.39503953989935, cost 479.42s 
-- epoch 20 
-- finished epoch in 1489.38s 
-- train score: 0.44743192440561, cost 972.94s 
-- test score: 0.3966314059772, cost 481.67s 
-- epoch 21 
-- finished epoch in 1489.08s 
-- train score: 0.45376955903272, cost 970.68s 
-- test score: 0.4009705248023, cost 479.76s 
-- epoch 22 
-- finished epoch in 1489.12s 
-- train score: 0.45992938427149, cost 972.07s 
-- test score: 0.40330697340043, cost 480.54s 
-- epoch 23 
-- finished epoch in 1489.38s 
-- train score: 0.46434921763869, cost 970.07s 
-- test score: 0.40867310259834, cost 480.81s 
-- epoch 24 
-- finished epoch in 1486.95s 
-- train score: 0.4731634830319, cost 971.73s 
-- test score: 0.41655540720961, cost 479.45s 
-- epoch 25 
-- finished epoch in 1489.45s 
-- train score: 0.48253657793131, cost 971.36s 
-- test score: 0.42140803122112, cost 481.93s 
-- epoch 26 
-- finished epoch in 1488.16s 
-- train score: 0.49217638691323, cost 971.28s 
-- test score: 0.43021464516792, cost 478.56s 
-- epoch 27 
-- finished epoch in 1489.31s 
-- train score: 0.49726935582199, cost 969.37s 
-- test score: 0.4358118516997, cost 481.01s 
-- epoch 28 
-- finished epoch in 1486.64s 
-- train score: 0.50438173135542, cost 971.50s 
-- test score: 0.43953476430112, cost 478.28s 
-- epoch 29 
-- finished epoch in 1493.58s 
-- train score: 0.51052885592359, cost 972.78s 
-- test score: 0.44536304816679, cost 482.61s 
-- epoch 30 
-- finished epoch in 1489.08s 
-- train score: 0.51506299532615, cost 975.17s 
-- test score: 0.44888055869364, cost 480.34s 
-- epoch 31 
-- finished epoch in 1491.11s 
-- train score: 0.52121011989433, cost 969.36s 
-- test score: 0.45062647632741, cost 481.85s 
-- epoch 32 
-- finished epoch in 1511.41s 
-- train score: 0.52430908351961, cost 973.86s 
-- test score: 0.45509397144911, cost 479.28s 
-- epoch 33 
-- finished epoch in 1493.26s 
-- train score: 0.52564265393213, cost 970.52s 
-- test score: 0.4575074458252, cost 482.56s 
-- epoch 34 
-- finished epoch in 1490.86s 
-- train score: 0.53154846575899, cost 975.28s 
-- test score: 0.45971551812673, cost 479.38s 
-- epoch 35 
-- finished epoch in 1489.92s 
-- train score: 0.5365017272912, cost 969.99s 
-- test score: 0.4621033172435, cost 481.19s 
-- epoch 36 
-- finished epoch in 1492.01s 
-- train score: 0.5384322292217, cost 976.21s 
-- test score: 0.46518434836192, cost 481.20s 
-- epoch 37 
-- finished epoch in 1490.61s 
-- train score: 0.54299176996545, cost 970.11s 
-- test score: 0.4659289308822, cost 480.37s 
-- epoch 38 
-- finished epoch in 1489.17s 
-- train score: 0.54488416988417, cost 973.21s 
-- test score: 0.46872753414809, cost 480.81s 
-- epoch 39 
-- finished epoch in 1487.74s 
-- train score: 0.54775452143873, cost 970.21s 
-- test score: 0.47160316319195, cost 479.21s 
-- epoch 40 
-- finished epoch in 1489.60s 
-- train score: 0.55214895346474, cost 971.16s 
-- test score: 0.473451781863, cost 480.98s 
-- epoch 41 
-- finished epoch in 1493.90s 
-- train score: 0.5539143466775, cost 972.74s 
-- test score: 0.47514634897812, cost 478.59s 
-- epoch 42 
-- finished epoch in 1489.24s 
-- train score: 0.55966775045722, cost 970.22s 
-- test score: 0.47784225120674, cost 480.77s 
-- epoch 43 
-- finished epoch in 1511.30s 
-- train score: 0.56031548465759, cost 971.54s 
-- test score: 0.47966519461847, cost 478.28s 
-- epoch 44 
-- finished epoch in 1489.93s 
-- train score: 0.56512903881325, cost 970.36s 
-- test score: 0.48128273595563, cost 481.64s 
-- epoch 45 
-- finished epoch in 1508.19s 
-- train score: 0.56700873806137, cost 972.79s 
-- test score: 0.48331108144192, cost 479.04s 
-- epoch 46 
-- finished epoch in 1492.09s 
-- train score: 0.57282564519407, cost 970.24s 
-- test score: 0.48325973092328, cost 481.47s 
-- epoch 47 
-- finished epoch in 1489.66s 
-- train score: 0.57175878886405, cost 973.33s 
-- test score: 0.4860840094485, cost 479.05s 
-- epoch 48 
-- finished epoch in 1497.64s 
-- train score: 0.57685175777281, cost 972.79s 
-- test score: 0.48600698367054, cost 483.44s 
-- epoch 49 
-- finished epoch in 1494.64s 
-- train score: 0.57829963422069, cost 976.61s 
-- test score: 0.4873677724145, cost 480.36s 
-- epoch 50 
-- finished epoch in 1496.74s 
-- train score: 0.58116998577525, cost 971.00s 
-- test score: 0.48829208175003, cost 482.84s 
-- epoch 51 
-- finished epoch in 1493.57s 
-- train score: 0.58564062182483, cost 977.37s 
-- test score: 0.49021772619903, cost 480.83s 
-- epoch 52 
-- finished epoch in 1496.55s 
-- train score: 0.58640266206056, cost 971.86s 
-- test score: 0.49137311286844, cost 482.68s 
-- epoch 53 
-- finished epoch in 1495.92s 
-- train score: 0.59020016256858, cost 977.01s 
-- test score: 0.49401766457841, cost 481.02s 
-- epoch 54 
-- finished epoch in 1489.13s 
-- train score: 0.58945082300345, cost 969.63s 
-- test score: 0.49340145835473, cost 480.60s 
-- epoch 55 
-- finished epoch in 1510.02s 
-- train score: 0.59439138386507, cost 973.03s 
-- test score: 0.49399198931909, cost 479.88s 
-- epoch 56 
-- finished epoch in 1489.16s 
-- train score: 0.59531853281853, cost 969.43s 
-- test score: 0.49432576769025, cost 480.13s 
-- epoch 57 
-- finished epoch in 1512.09s 
-- train score: 0.59939544807966, cost 973.00s 
-- test score: 0.49825408236623, cost 480.87s 
-- epoch 58 
-- finished epoch in 1509.25s 
-- train score: 0.59975106685633, cost 969.09s 
-- test score: 0.49745814932731, cost 479.79s 
-- epoch 59 
-- finished epoch in 1489.82s 
-- train score: 0.60431060760008, cost 972.73s 
-- test score: 0.49851083495943, cost 481.55s 
-- epoch 60 
-- finished epoch in 1490.53s 
-- train score: 0.60362477138793, cost 973.23s 
-- test score: 0.49953784533224, cost 479.37s 
-- epoch 61 
-- finished epoch in 1512.89s 
-- train score: 0.60692694574274, cost 973.50s 
-- test score: 0.50053918044572, cost 482.31s 
-- epoch 62 
-- finished epoch in 1488.91s 
-- train score: 0.61094035765088, cost 971.81s 
-- test score: 0.50059053096436, cost 478.99s 
-- epoch 63 
-- finished epoch in 1496.79s 
-- train score: 0.61189290794554, cost 973.73s 
-- test score: 0.50164321659649, cost 483.37s 
-- epoch 64 
-- finished epoch in 1488.20s 
-- train score: 0.61511887827677, cost 973.08s 
-- test score: 0.5033121084523, cost 479.11s 
-- epoch 65 
-- finished epoch in 1512.05s 
-- train score: 0.61548719772404, cost 971.41s 
-- test score: 0.50354318578618, cost 482.77s 
-- epoch 66 
-- finished epoch in 1488.29s 
-- train score: 0.6172652916074, cost 973.67s 
-- test score: 0.50436479408442, cost 478.76s 
-- epoch 67 
-- finished epoch in 1489.36s 
-- train score: 0.61956411298517, cost 968.50s 
-- test score: 0.50503235082674, cost 481.03s 
-- epoch 68 
-- finished epoch in 1487.16s 
-- train score: 0.62265037593985, cost 974.11s 
-- test score: 0.50544315497587, cost 478.89s 
-- epoch 69 
-- finished epoch in 1489.26s 
-- train score: 0.62226935582199, cost 968.47s 
-- test score: 0.50644449008935, cost 481.21s 
-- epoch 70 
-- finished epoch in 1487.19s 
-- train score: 0.62512700670595, cost 973.60s 
-- test score: 0.50664989216391, cost 478.50s 
-- epoch 71 
-- finished epoch in 1494.53s 
-- train score: 0.62458087787035, cost 971.96s 
-- test score: 0.50670124268255, cost 482.62s 
-- epoch 72 
-- finished epoch in 1493.58s 
-- train score: 0.62813706563707, cost 976.24s 
-- test score: 0.50672691794187, cost 480.91s 
-- epoch 73 
-- finished epoch in 1490.78s 
-- train score: 0.6310836212152, cost 969.59s 
-- test score: 0.50713772209099, cost 481.02s 
-- epoch 74 
-- finished epoch in 1490.14s 
-- train score: 0.6343984962406, cost 973.11s 
-- test score: 0.50975659854165, cost 480.29s 
-- epoch 75 
-- finished epoch in 1490.33s 
-- train score: 0.63527484251168, cost 971.30s 
-- test score: 0.50821608298244, cost 480.96s 
-- epoch 76 
-- finished epoch in 1515.15s 
-- train score: 0.63691322901849, cost 974.74s 
-- test score: 0.50926876861456, cost 481.05s 
-- epoch 77 
-- finished epoch in 1488.87s 
-- train score: 0.63952956716115, cost 971.50s 
-- test score: 0.51093766047037, cost 479.71s 
-- epoch 78 
-- finished epoch in 1497.72s 
-- train score: 0.64231101402154, cost 976.31s 
-- test score: 0.50890931498408, cost 483.46s 
-- epoch 79 
-- finished epoch in 1494.78s 
-- train score: 0.6418791912213, cost 975.02s 
-- test score: 0.51124576358221, cost 480.71s 
-- epoch 80 
-- finished epoch in 1493.98s 
-- train score: 0.64495275350539, cost 974.15s 
-- test score: 0.51181061928725, cost 482.98s 
-- epoch 81 
-- finished epoch in 1488.15s 
-- train score: 0.64690865677708, cost 972.80s 
-- test score: 0.51234979973298, cost 479.36s 
-- epoch 82 
-- finished epoch in 1496.15s 
-- train score: 0.6509855720382, cost 973.87s 
-- test score: 0.51283762966006, cost 482.94s 
-- epoch 83 
-- finished epoch in 1487.70s 
-- train score: 0.65165870757976, cost 972.75s 
-- test score: 0.51424976892267, cost 479.36s 
-- epoch 84 
-- finished epoch in 1495.24s 
-- train score: 0.65198892501524, cost 974.06s 
-- test score: 0.51247817602958, cost 483.20s 
-- epoch 85 
-- finished epoch in 1493.00s 
-- train score: 0.65711999593579, cost 975.04s 
-- test score: 0.51401869158878, cost 480.60s 
-- epoch 86 
-- finished epoch in 1494.05s 
-- train score: 0.65435124974599, cost 972.67s 
-- test score: 0.51373626373626, cost 482.91s 
-- epoch 87 
-- finished epoch in 1495.60s 
-- train score: 0.65973633407844, cost 977.18s 
-- test score: 0.51383896477354, cost 480.52s 
-- epoch 88 
-- finished epoch in 1516.74s 
-- train score: 0.65944421865475, cost 973.74s 
-- test score: 0.51597001129711, cost 483.82s 
-- epoch 89 
-- finished epoch in 1495.56s 
-- train score: 0.66230186953871, cost 979.15s 
-- test score: 0.51543083085139, cost 480.90s 
-- epoch 90 
-- finished epoch in 1491.17s 
-- train score: 0.66334332452754, cost 968.26s 
-- test score: 0.51766457841224, cost 481.19s 
-- epoch 91 
-- finished epoch in 1492.11s 
-- train score: 0.6673186344239, cost 978.27s 
-- test score: 0.51694567115128, cost 481.94s 
-- epoch 92 
-- finished epoch in 1499.03s 
-- train score: 0.66636608412924, cost 973.66s 
-- test score: 0.51702269692924, cost 482.45s 
-- epoch 93 
-- finished epoch in 1496.23s 
-- train score: 0.66853789880106, cost 977.59s 
-- test score: 0.51792133100544, cost 482.11s 
-- epoch 94 
-- finished epoch in 1494.97s 
-- train score: 0.66966825848405, cost 973.13s 
-- test score: 0.52012940330697, cost 482.10s 
-- epoch 95 
-- finished epoch in 1491.13s 
-- train score: 0.67029059134322, cost 972.31s 
-- test score: 0.5210537126425, cost 480.20s 
-- epoch 96 
-- finished epoch in 1490.01s 
-- train score: 0.67205598455598, cost 970.92s 
-- test score: 0.51894834137825, cost 479.53s 
-- epoch 97 
-- finished epoch in 1492.53s 
-- train score: 0.67512954684007, cost 972.08s 
-- test score: 0.52082263530862, cost 480.77s 
-- epoch 98 
-- finished epoch in 1487.69s 
-- train score: 0.67758077626499, cost 969.17s 
-- test score: 0.51902536715621, cost 486.81s 
-- epoch 99 
-- finished epoch in 1511.23s 
-- train score: 0.67638691322902, cost 971.45s 
-- test score: 0.52113073842046, cost 482.71s 
-- epoch 100 
-- finished epoch in 1729.67s 
-- train score: 0.67921916277179, cost 993.00s 
-- test score: 0.51892266611893, cost 478.77s 
finished training in 295040.70s 
best dev score is: 0.52113073842046 
writing model to ./done/vqalstm-COCOQA-lstm.l1.d150.e99.c1-2016-01-25T202841.t7 
