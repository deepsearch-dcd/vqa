[program started on Fri Dec  4 17:15:52 2015] 
[command line arguments] 
[----------------------] 
-------------------------------------------------------------------------------- 
LSTM for VQA 
-------------------------------------------------------------------------------- 
loading datasets 
process data at: /home/deepnet/lyt/vqa/dataset/data/DAQUAR/DAQUAR-ALL 
Process_all_totable ... 
load train set ... 
total lines: 13590 
max length: 31 min length: 7 
#images: 6795 #questions: 6795 #answers: 6795 
normalize image: 6808 
load test set ... 
total lines: 11346 
max length: 28 min length: 7 
#images: 5673 #questions: 5673 #answers: 5673 
normalize image: 5681 
build vocabulary ... 
word vocabulary: 856 
answer vocabulary: 969 
image vocabulary: 1447 
num train = 6795 
num test  = 5673 
loading features 
-------------------------------------------------------------------------------- 
model configuration 
-------------------------------------------------------------------------------- 
max epochs                = 100 
num params                = 234169 
num compositional params  = 87850 
word vector dim           = 50 
LSTM memory dim           = 150 
LSTM structure            = rnn 
LSTM layers               = 1 
regularization strength   = 1.00e-04 
minibatch size            = 1 
learning rate             = 5.00e-02 
word vector learning rate = 1.00e-01 
dropout                   = true 
cuda                      = true 
image feature dim         = 1000 
-------------------------------------------------------------------------------- 
Training model 
-------------------------------------------------------------------------------- 
-- epoch 1 
-- finished epoch in 23.29s 
-- train score: 0.041795437821928, cost 70.72s 
-- test score: 0.046359950643399, cost 59.35s 
-- epoch 2 
-- finished epoch in 22.64s 
-- train score: 0.043708609271523, cost 69.24s 
-- test score: 0.044420941300899, cost 57.76s 
-- epoch 3 
-- finished epoch in 21.69s 
-- train score: 0.040765268579838, cost 69.17s 
-- test score: 0.031552970209766, cost 57.77s 
-- epoch 4 
-- finished epoch in 21.64s 
-- train score: 0.031788079470199, cost 66.84s 
-- test score: 0.034020800282038, cost 55.59s 
-- epoch 5 
-- finished epoch in 21.37s 
-- train score: 0.032671081677704, cost 66.66s 
-- test score: 0.035078441741583, cost 55.70s 
-- epoch 6 
-- finished epoch in 21.36s 
-- train score: 0.038704930095659, cost 66.68s 
-- test score: 0.040014101886127, cost 55.68s 
-- epoch 7 
-- finished epoch in 21.38s 
-- train score: 0.040029433406917, cost 66.69s 
-- test score: 0.049709148598625, cost 55.69s 
-- epoch 8 
-- finished epoch in 21.40s 
-- train score: 0.04326710816777, cost 66.67s 
-- test score: 0.040190375462718, cost 55.66s 
-- epoch 9 
-- finished epoch in 21.43s 
-- train score: 0.048417954378219, cost 66.73s 
-- test score: 0.050590516481579, cost 55.72s 
-- epoch 10 
-- finished epoch in 21.38s 
-- train score: 0.056512141280353, cost 66.70s 
-- test score: 0.054292261589988, cost 55.69s 
-- epoch 11 
-- finished epoch in 21.39s 
-- train score: 0.066666666666667, cost 66.70s 
-- test score: 0.064516129032258, cost 55.70s 
-- epoch 12 
-- finished epoch in 21.38s 
-- train score: 0.087122884473878, cost 66.66s 
-- test score: 0.084787590340208, cost 55.64s 
-- epoch 13 
-- finished epoch in 21.46s 
-- train score: 0.09654157468727, cost 66.66s 
-- test score: 0.095011457782478, cost 55.70s 
-- epoch 14 
-- finished epoch in 21.41s 
-- train score: 0.097718910963944, cost 66.74s 
-- test score: 0.094482637052706, cost 55.74s 
-- epoch 15 
-- finished epoch in 21.41s 
-- train score: 0.10669610007358, cost 66.73s 
-- test score: 0.096421646395205, cost 55.75s 
-- epoch 16 
-- finished epoch in 21.36s 
-- train score: 0.10978660779985, cost 66.80s 
-- test score: 0.096245372818614, cost 55.77s 
-- epoch 17 
-- finished epoch in 21.39s 
-- train score: 0.1168506254599, cost 66.69s 
-- test score: 0.10787942887361, cost 55.75s 
-- epoch 18 
-- finished epoch in 21.44s 
-- train score: 0.1168506254599, cost 66.72s 
-- test score: 0.099947117927023, cost 55.70s 
-- epoch 19 
-- finished epoch in 21.40s 
-- train score: 0.12229580573951, cost 66.71s 
-- test score: 0.11281508901816, cost 55.67s 
-- epoch 20 
-- finished epoch in 21.40s 
-- train score: 0.12568064753495, cost 66.70s 
-- test score: 0.11069980609907, cost 55.67s 
-- epoch 21 
-- finished epoch in 21.36s 
-- train score: 0.12111846946284, cost 66.69s 
-- test score: 0.11299136259475, cost 55.67s 
-- epoch 22 
-- finished epoch in 21.42s 
-- train score: 0.12759381898455, cost 66.67s 
-- test score: 0.11528291909043, cost 55.69s 
-- epoch 23 
-- finished epoch in 21.40s 
-- train score: 0.12980132450331, cost 66.53s 
-- test score: 0.11845584346906, cost 55.66s 
-- epoch 24 
-- finished epoch in 21.35s 
-- train score: 0.13701250919794, cost 66.72s 
-- test score: 0.12198131500088, cost 55.71s 
-- epoch 25 
-- finished epoch in 21.41s 
-- train score: 0.14481236203091, cost 66.67s 
-- test score: 0.12621188083906, cost 55.67s 
-- epoch 26 
-- finished epoch in 21.37s 
-- train score: 0.14790286975717, cost 66.89s 
-- test score: 0.13291027674952, cost 55.69s 
-- epoch 27 
-- finished epoch in 23.13s 
-- train score: 0.14613686534216, cost 66.59s 
-- test score: 0.11933721135202, cost 55.62s 
-- epoch 28 
-- finished epoch in 21.30s 
-- train score: 0.14849153789551, cost 66.56s 
-- test score: 0.13026617310065, cost 55.57s 
-- epoch 29 
-- finished epoch in 21.31s 
-- train score: 0.1514348785872, cost 66.71s 
-- test score: 0.12621188083906, cost 55.63s 
-- epoch 30 
-- finished epoch in 21.34s 
-- train score: 0.14363502575423, cost 66.49s 
-- test score: 0.13185263528997, cost 55.51s 
-- epoch 31 
-- finished epoch in 21.37s 
-- train score: 0.16364974245769, cost 66.64s 
-- test score: 0.13079499383042, cost 55.63s 
-- epoch 32 
-- finished epoch in 21.34s 
-- train score: 0.15879323031641, cost 66.53s 
-- test score: 0.13555438039838, cost 55.53s 
-- epoch 33 
-- finished epoch in 21.44s 
-- train score: 0.1598233995585, cost 66.63s 
-- test score: 0.13537810682179, cost 55.65s 
-- epoch 34 
-- finished epoch in 21.41s 
-- train score: 0.15864606328182, cost 66.68s 
-- test score: 0.13291027674952, cost 55.70s 
-- epoch 35 
-- finished epoch in 21.42s 
-- train score: 0.16394407652686, cost 66.65s 
-- test score: 0.13678829543451, cost 55.65s 
-- epoch 36 
-- finished epoch in 21.33s 
-- train score: 0.17350993377483, cost 66.74s 
-- test score: 0.13308655032611, cost 55.64s 
-- epoch 37 
-- finished epoch in 21.34s 
-- train score: 0.16909492273731, cost 66.59s 
-- test score: 0.13996121981315, cost 55.50s 
-- epoch 38 
-- finished epoch in 21.41s 
-- train score: 0.17601177336277, cost 66.58s 
-- test score: 0.13925612550679, cost 55.56s 
-- epoch 39 
-- finished epoch in 21.38s 
-- train score: 0.17247976453274, cost 66.59s 
-- test score: 0.1390798519302, cost 55.64s 
-- epoch 40 
-- finished epoch in 21.38s 
-- train score: 0.17704194260486, cost 66.65s 
-- test score: 0.13502555966861, cost 55.62s 
-- epoch 41 
-- finished epoch in 21.34s 
-- train score: 0.17763061074319, cost 66.64s 
-- test score: 0.13379164463247, cost 55.66s 
-- epoch 42 
-- finished epoch in 21.33s 
-- train score: 0.18278145695364, cost 66.61s 
-- test score: 0.13731711616429, cost 55.59s 
-- epoch 43 
-- finished epoch in 21.38s 
-- train score: 0.17601177336277, cost 66.50s 
-- test score: 0.14172395557906, cost 55.61s 
-- epoch 44 
-- finished epoch in 21.37s 
-- train score: 0.18940397350993, cost 66.47s 
-- test score: 0.14066631411951, cost 55.44s 
-- epoch 45 
-- finished epoch in 21.37s 
-- train score: 0.18749080206034, cost 66.45s 
-- test score: 0.13996121981315, cost 55.45s 
-- epoch 46 
-- finished epoch in 21.34s 
-- train score: 0.1972038263429, cost 66.64s 
-- test score: 0.13996121981315, cost 55.63s 
-- epoch 47 
-- finished epoch in 21.36s 
-- train score: 0.19293598233996, cost 66.56s 
-- test score: 0.14119513484929, cost 55.60s 
-- epoch 48 
-- finished epoch in 21.40s 
-- train score: 0.19470198675497, cost 66.63s 
-- test score: 0.14930371937247, cost 55.61s 
-- epoch 49 
-- finished epoch in 21.35s 
-- train score: 0.19455481972038, cost 66.40s 
-- test score: 0.13784593689406, cost 55.52s 
-- epoch 50 
-- finished epoch in 21.38s 
-- train score: 0.20029433406917, cost 66.71s 
-- test score: 0.14595452141724, cost 55.66s 
-- epoch 51 
-- finished epoch in 21.39s 
-- train score: 0.20441501103753, cost 68.05s 
-- test score: 0.14789353075974, cost 55.60s 
-- epoch 52 
-- finished epoch in 21.40s 
-- train score: 0.19690949227373, cost 66.64s 
-- test score: 0.14119513484929, cost 55.67s 
-- epoch 53 
-- finished epoch in 21.40s 
-- train score: 0.21089036055923, cost 66.60s 
-- test score: 0.14436805922792, cost 55.70s 
-- epoch 54 
-- finished epoch in 21.41s 
-- train score: 0.19970566593083, cost 66.65s 
-- test score: 0.13855103120042, cost 55.63s 
-- epoch 55 
-- finished epoch in 21.42s 
-- train score: 0.20309050772627, cost 66.65s 
-- test score: 0.14154768200247, cost 55.62s 
-- epoch 56 
-- finished epoch in 21.39s 
-- train score: 0.20588668138337, cost 66.69s 
-- test score: 0.14613079499383, cost 55.67s 
-- epoch 57 
-- finished epoch in 21.40s 
-- train score: 0.21177336276674, cost 66.66s 
-- test score: 0.13784593689406, cost 55.65s 
-- epoch 58 
-- finished epoch in 21.43s 
-- train score: 0.21648270787344, cost 66.64s 
-- test score: 0.14595452141724, cost 55.63s 
-- epoch 59 
-- finished epoch in 21.42s 
-- train score: 0.21957321559971, cost 66.63s 
-- test score: 0.14242904988542, cost 55.65s 
-- epoch 60 
-- finished epoch in 21.40s 
-- train score: 0.21368653421634, cost 66.62s 
-- test score: 0.14771725718315, cost 55.58s 
-- epoch 61 
-- finished epoch in 21.37s 
-- train score: 0.22016188373804, cost 66.63s 
-- test score: 0.14630706857042, cost 55.50s 
-- epoch 62 
-- finished epoch in 21.39s 
-- train score: 0.22752023546726, cost 66.61s 
-- test score: 0.14754098360656, cost 55.65s 
-- epoch 63 
-- finished epoch in 21.38s 
-- train score: 0.23164091243561, cost 66.62s 
-- test score: 0.15318173805747, cost 55.63s 
-- epoch 64 
-- finished epoch in 21.46s 
-- train score: 0.22958057395143, cost 66.61s 
-- test score: 0.14912744579588, cost 55.61s 
-- epoch 65 
-- finished epoch in 21.44s 
-- train score: 0.23208241353937, cost 66.63s 
-- test score: 0.1447206063811, cost 55.68s 
-- epoch 66 
-- finished epoch in 21.44s 
-- train score: 0.23046357615894, cost 66.66s 
-- test score: 0.14965626652565, cost 55.72s 
-- epoch 67 
-- finished epoch in 21.42s 
-- train score: 0.23561442236939, cost 66.67s 
-- test score: 0.15230037017451, cost 55.64s 
-- epoch 68 
-- finished epoch in 21.44s 
-- train score: 0.23399558498896, cost 66.66s 
-- test score: 0.15300546448087, cost 55.64s 
-- epoch 69 
-- finished epoch in 21.42s 
-- train score: 0.24738778513613, cost 66.66s 
-- test score: 0.15547329455315, cost 55.65s 
-- epoch 70 
-- finished epoch in 21.45s 
-- train score: 0.23855776306107, cost 66.57s 
-- test score: 0.15000881367883, cost 55.54s 
-- epoch 71 
-- finished epoch in 21.42s 
-- train score: 0.24385577630611, cost 66.65s 
-- test score: 0.14789353075974, cost 55.56s 
-- epoch 72 
-- finished epoch in 21.44s 
-- train score: 0.21766004415011, cost 66.69s 
-- test score: 0.14366296492156, cost 55.63s 
-- epoch 73 
-- finished epoch in 22.19s 
-- train score: 0.24635761589404, cost 67.57s 
-- test score: 0.1485986250661, cost 55.54s 
-- epoch 74 
-- finished epoch in 21.39s 
-- train score: 0.2242825607064, cost 66.70s 
-- test score: 0.14736471002997, cost 55.65s 
-- epoch 75 
-- finished epoch in 21.41s 
-- train score: 0.24885945548197, cost 66.64s 
-- test score: 0.15124272871497, cost 55.62s 
-- epoch 76 
-- finished epoch in 21.44s 
-- train score: 0.25974981604121, cost 66.60s 
-- test score: 0.15776485104883, cost 55.66s 
-- epoch 77 
-- finished epoch in 21.44s 
-- train score: 0.25459896983076, cost 66.67s 
-- test score: 0.15124272871497, cost 55.68s 
-- epoch 78 
-- finished epoch in 21.47s 
-- train score: 0.26181015452539, cost 66.66s 
-- test score: 0.15353428521065, cost 55.60s 
-- epoch 79 
-- finished epoch in 21.46s 
-- train score: 0.25901398086829, cost 66.62s 
-- test score: 0.15547329455315, cost 55.60s 
-- epoch 80 
-- finished epoch in 21.45s 
-- train score: 0.26107431935247, cost 66.64s 
-- test score: 0.15423937951701, cost 55.63s 
-- epoch 81 
-- finished epoch in 21.43s 
-- train score: 0.2579838116262, cost 66.56s 
-- test score: 0.15582584170633, cost 55.61s 
-- epoch 82 
-- finished epoch in 21.44s 
-- train score: 0.25548197203826, cost 66.65s 
-- test score: 0.15494447382337, cost 55.66s 
-- epoch 83 
-- finished epoch in 21.42s 
-- train score: 0.27446651949963, cost 66.62s 
-- test score: 0.15476820024678, cost 55.65s 
-- epoch 84 
-- finished epoch in 22.62s 
-- train score: 0.27932303164091, cost 68.58s 
-- test score: 0.15300546448087, cost 55.63s 
-- epoch 85 
-- finished epoch in 22.17s 
-- train score: 0.26754966887417, cost 66.54s 
-- test score: 0.15141900229156, cost 55.59s 
-- epoch 86 
-- finished epoch in 21.36s 
-- train score: 0.28653421633554, cost 66.60s 
-- test score: 0.15194782302133, cost 55.60s 
-- epoch 87 
-- finished epoch in 21.35s 
-- train score: 0.27579102281089, cost 66.54s 
-- test score: 0.15794112462542, cost 55.62s 
-- epoch 88 
-- finished epoch in 21.40s 
-- train score: 0.27402501839588, cost 66.66s 
-- test score: 0.14983254010224, cost 55.61s 
-- epoch 89 
-- finished epoch in 21.40s 
-- train score: 0.27902869757174, cost 66.58s 
-- test score: 0.15406310594042, cost 55.55s 
-- epoch 90 
-- finished epoch in 21.37s 
-- train score: 0.28050036791759, cost 66.58s 
-- test score: 0.16005640754451, cost 55.57s 
-- epoch 91 
-- finished epoch in 21.47s 
-- train score: 0.28550404709345, cost 66.59s 
-- test score: 0.15794112462542, cost 55.59s 
-- epoch 92 
-- finished epoch in 21.47s 
-- train score: 0.30080941869021, cost 66.60s 
-- test score: 0.15124272871497, cost 55.54s 
-- epoch 93 
-- finished epoch in 21.46s 
-- train score: 0.27122884473878, cost 66.59s 
-- test score: 0.15423937951701, cost 55.60s 
-- epoch 94 
-- finished epoch in 21.47s 
-- train score: 0.29668874172185, cost 66.61s 
-- test score: 0.15212409659792, cost 55.64s 
-- epoch 95 
-- finished epoch in 21.45s 
-- train score: 0.28962472406181, cost 66.57s 
-- test score: 0.15406310594042, cost 55.66s 
-- epoch 96 
-- finished epoch in 21.45s 
-- train score: 0.29668874172185, cost 66.56s 
-- test score: 0.15318173805747, cost 58.26s 
-- epoch 97 
-- finished epoch in 21.41s 
-- train score: 0.3018395879323, cost 66.66s 
-- test score: 0.15159527586815, cost 55.63s 
-- epoch 98 
-- finished epoch in 21.35s 
-- train score: 0.28903605592347, cost 66.63s 
-- test score: 0.15388683236383, cost 55.66s 
-- epoch 99 
-- finished epoch in 21.38s 
-- train score: 0.30272259013981, cost 66.62s 
-- test score: 0.15846994535519, cost 55.63s 
-- epoch 100 
-- finished epoch in 21.38s 
-- train score: 0.29757174392936, cost 66.65s 
-- test score: 0.15388683236383, cost 55.59s 
finished training in 14400.26s 
best dev score is: 0.16005640754451 
writing model to ./done/vqalstm-rnn.l1.d150.e90.c1-2015-12-04T211553.t7 
